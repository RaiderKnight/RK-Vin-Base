WHAT: all
WHERE: all, -home, -hotel
WHEN: 22 - 4
WHO: Actor2 = getCompanion(); If Random(50, 300) < Actor2:attractiveness
OTHER: intelligence < Random(0, 100)*Random(0, 1)*Random(0, 1)

    SceneStart()

        Hunger = Player.getActorVar(rk_VB_Hunger)
        HungerEnable = rk_VB_EnableHunger.getGlobal()
        UrgeToPeeEnable = rk_VB_UrgeToPeeEnable.getGlobal()
        UrgeToPee = Player.getActorVar(rk_VB_UrgeToPee)
        setBackground(street)
        "Damn it's dark in here. I shouldn't have gone for that shortcut just to save a few minutes. Too late to regret now - I'll just walk fast and get the hell out of here - I don't feel safe."
        Actor = generatePersonTemporary()
        While !Player.isInterestedIn(Actor)
            Actor = generatePersonTemporary()
        Endwhile
        // Start edit Raddeck
        Actor2 = generatePersonTemporary()
        While !Player.isInterestedIn(Actor2)
            Actor2 = generatePersonTemporary()
        Endwhile
        Actor3 = generatePersonTemporary()
        While !Player.isInterestedIn(Actor3)
            Actor3 = generatePersonTemporary()
        Endwhile
        Actor2.dressUniform(Crime)
        Actor2.show(2)
        Actor3.dressUniform(Crime)
        Actor3.show(3)
        // End edit Raddeck
        Actor.dressUniform(Crime)
        Actor.show(1)
        "Oh no, I'm surrounded by three shady characters ..."
        Actor(Evil):: "Alright, I'll make this quick: hand over your ...."
        Actor2(Flirty):: "... Oh, what a surprise to see a beauty like you alone here. It must be my lucky day. I think you can give me something a hell lot better than your <Player.wallet_or_purse> ..."
        Actor3(Flirty):: "Let's rape <Player.him_or_her> together!" //Edit Raddeck
        "Oh no, I don't like how this is going ..."
        0:: "Just take my money"
        1:: "Run"
        2:: "Attack"
        
        If 0
            Player.animate(fightlost)
            Player(Scared):: "Please, just take my money ... Don't harm me ..."
            "I obediently handed over my <Player.wallet_or_purse>, hoping that it would be enough to keep the thug off me." //Edit Raddeck
            money -= Random(30, 300)
            If Random(0, 100) < Player:interpersonal - Actor:perversion
                Actor(Evil):: "Fine, since you're being so compliant, I'll let you go. Don't you dare call the cops!"
                Rape = false
            Else
                Actor(Evil):: "Thanks for handing over your money so obediently. But you're naive to think I'll let you two go just like that."
                Rape = true
            Endif
        Elseif 1
            "I decided to make a run for it!"
            If Random(0, 200) < Player:fitness
                Actor.hide()
                "I did it! The thugs were long left behind and I escaped. Phew, that was close."
                Rape = false
                "Unfortunately <Actor2.name> was left behind also ... I can't imagine what horrible things  <Actor2.he_or_she> is enduring right now ... Oh well, better <Actor2.him_or_her> than me!"
                Actor2:attractiontoplayer -= Random(0, 50)
                Actor2:rapportwithplayer -= Random(0, 50)
            Else
                money -= Random(30, 300)
                "I tried to escape but the thug was too fast for me and knocked me down to the ground."
                Actor(Evil):: "I think you can just run away? You should have saved the energy to endure a hard pounding from me later."
                Rape = true
            Endif
            If HungerEnable > 0
                Player.modifyActorVar(rk_VB_Hunger, -10)
            EndIf
            
        Else
            Player.animate(martialart)
            Player.moveToPersonStand(Actor, 100)        
            Player(Furious):: "You messed with the wrong <Player.guy_or_girl>! Take this."
            faceEachOther(Actor, Player)
            Actor.animate(martialart)        
            Actor(Furious):: "You dare sucker-punch me? I'll teach you a lesson."
            "A fierce fight ensued ..."
            Player.animate()
            Actor.animate()
            If Actor:martial - Actor:intoxication < martial - intoxication
                Rape = false
                Actor.animate(fightlost)
                Actor(Pain):: "Ah!"
                Player(Angry):: "That should teach you to never ambush innocent people in dark alleys anymore."
                Actor2:attractiontoplayer += Random(0, 5)
                Actor2:rapportwithplayer += Random(0, 5)
            Else
                money -= Random(30, 300)
                Rape = true
                Player.animate(fightlost)
                Player(Pain):: "Ah!"
                Actor(Evil):: "Ha! You really thought you could match me in a fight? I have to say - this just makes us want to fuck your brains out even more, you'll see how we conquer this wild bitch tonight!"
                
                If HungerEnable > 0
                    Player.modifyActorVar(rk_VB_Hunger, -10)
                EndIf
            EndIf
        Endif
        
        If Rape
            Player.animate(fightlost)
            ActorPerv = Actor:perversion // Edit Raddeck
            Actor2Perv = Actor2:perversion // Edit Raddeck
            Actor3Perv = Actor3:perversion // Edit Raddeck
            TotalPerv = ActorPerv + ActorPerv2 + ActorPerv3 // Edit Raddeck
            If TotalPerv > 75 // Edit Raddeck
                Player.animate(fightlost)
                "I was tied up in the corner, forced to watch."
                "Soon, the thug was ripping <Actor2.name>'s clothes off and proceeded to force <Actor.himself_or_herself> upon <Actor2.him_or_her>."
                Actor2.animate(fightlost)
                Actor2(Crying):: "No! Please stop ... I beg you ... Somebody help ..."
                "<Actor2.His_or_Her> cries for help went unheard in the dark alley and <Actor2.he_or_she> had no choice but endure it all at the hand of this vile <Actor.man_or_woman>."
                Filter(Aggressive)
                TalkNonConsensual()
                SexNoAffair(Actor, Actor2)
                Actor2.hide()
                Actor.show(2)
                Actor(Evil):: "Now it's your turn, bitch. Let's see if you can breed as well as your friend did!"
                Filter(Aggressive)
                TalkNonConsensual()
                SexNoAffair(Actor, Player)
                If HungerEnable > 0
                    Player.modifyActorVar(rk_VB_Hunger, -3)
                EndIf
                Actor.setActorVar(tag_Rapist, 1)
                mood => 0
                money -= Random(30, 300)
                // Start edit Raddeck
            Else
                "Soon, They were ripping my clothes off and proceeded to force themselves upon me."
                Player(Crying):: "No! Please stop ... I beg you ... Somebody help ..."
                If Random(0, 100) < 30
                    "All of a sudden, I heard a police siren. The thugs were terrified and made a run for it."
                    Actor.hide()
                    Actor2.hide()
                    Actor3.hide()
                    "Three cops arrived at the scene, finding me in all state of undress. Apparently a passerby saw what was happening and called the cops, who responded immediately. Good thing they did, this night could have gone a lot worse."
                    mood -= Random(0, 50)
                Else
                    "Our cries for help went unheard in the dark alley and we had no choice but endure the worst night of our life at the hand of the three vile <Actor.men_or_women>."
                    Filter(Aggressive)
                    TalkNonConsensual()
                    SexNoAffair(Actor, Actor2)
                    Actor2.hide()
                    Actor.show(2)
                    Actor(Evil):: "Now it's your turn, bitch. Let's see if you can breed as well as your friend did!"
                    Filter(Aggressive)
                    TalkNonConsensual()
                    SexNoAffair(Actor, Actor2, Actor3, Player)
                    Actor.setActorVar(tag_Rapist, 1)
                    If HungerEnable > 0
                        Player.modifyActorVar(rk_VB_Hunger, -5)
                    EndIf
                    mood => 0
                    money -= Random(30, 300)
                Endif
                // End edit Raddeck
            Endif
        Endif
    SceneEnd() // Improved by Raddeck
    timeout(500, vi_darkalley_gangrape_cms)