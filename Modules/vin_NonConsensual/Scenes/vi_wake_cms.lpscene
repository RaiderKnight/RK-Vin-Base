WHAT: sleep
WHERE: home
WHEN: 22 - 4
WHO: none
OTHER: !Player.isAsexual() && Random(0, 100) < 5

    SceneStart()
        IBuyaASys = rk_VB_IBuyaASys.getGlobal()
        AlarmEnable = rk_VB_AlarmEnable.getGlobal()
        If IBuyaASys > 0
            KRisk = 0
            If IBuyaASys == 1
                KRisk = 50
            Elseif IBuyaASys == 2
                KRisk = 75
            Elseif IBuyaASys == 3
                KRisk = 90
            Endif
        Endif
        KidnapAttemp = random(0, 100)
        
        If [KRisk > KidnapAttemp] && AlarmEnable > 0
            "All of a sudden the alarm system starts ringing."
            Player(Curious):: "WTF, well, let's go see what's going on!"
            Player(Curious):: "Hum, I can't see anything!"
            Player(Curious):: "Let's hope it was just an animal..."
        Else
            Hunger = Player.getActorVar(rk_VB_Hunger)
            HungerEnable = rk_VB_EnableHunger.getGlobal()
            UrgeToPeeEnable = rk_VB_UrgeToPeeEnable.getGlobal()
            UrgeToPee = Player.getActorVar(rk_VB_UrgeToPee)
        
            Player.animate(na_sleep)
            Actor = generatePersonTemporary()
            While !Player.isInterestedIn(Actor)
                Actor = generatePersonTemporary()
            Endwhile
            Actor.dressUniform(Crime)
            Actor.show()
            "In the middle of the night ..."
            Actor.animate(na_sleep)
            "I was suddenly awakened to the sight of horror, some stranger already naked in my bed trying to rape me ..." // Edit by Ravenger6660
            0:: "Resist"
            1:: "I might enjoy this actually ..."
            
            If 0
                If martial < Actor:martial
                    "Unfortunately, my assailant was too strong for me ..."
                    Rape = true
                Else
                    "I managed to push my assailant off me. Defeated, <Actor.he_or_she> promptly jumped out of the window and made a run for it ..."
                    "Phew, that was close ..."
                    Rape = false
                Endif
            Else
                Rape = true
                masochist += 2
            Endif
            If Rape
                If !Actor.isMale() && Player.isMale()
                    Filter(AggressiveFM)
                Else
                    Filter(Aggressive)
                Endif
                TalkNonConsensual()
                Sex(Actor, Player)
                Actor.setActorVar(tag_Rapist, 1)
                If HungerEnable > 0
                    Player.modifyActorVar(rk_VB_Hunger, -3)
                EndIf
            Endif
        Endif
    SceneEnd()
    timeout(200, vi_wake_cms) // Improved by Raddeck