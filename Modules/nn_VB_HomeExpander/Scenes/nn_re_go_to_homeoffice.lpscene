WHAT: none
WHERE: none
WHEN: 0 - 24
WHO: none
OTHER: none

    If !isAtHome() && PlayerHasHome()
        moveTo(home)
    EndIf
    
    If !PlayerHasHome()
        SceneStart()
        "You need to find a personal home first!"
        SceneEnd()
    Else
        clearGetList()  // sometimes the getGlobal/getSpecific calls do not work without this call
        hasRoom = RE_has_officeroom.getGlobal()
        
        // Move to the room
        If hasRoom > 0
            setBackground3D(Modules/nn_VB_HomeExpander/Rooms/re_homeoffice.lpworld)
        Else
            setBackground3D(Modules/nn_VB_HomeExpander/Rooms/re_empty.lpworld)
        EndIf
        
        Player.animate()
        Player.show(42,18,0)  // show up at the door
        cameraFocus(Player)
        
        // If MC has animals show them randomly (usually they stick to the MC at home...)
        Actor = getCreature()
        If Actor.isValid() && Actor.isCreatureType(Dog)
            chance = Random(0,6)
            If chance>=3
                Actor.show()
            Else
                Actor.hide()
            EndIf
        EndIf
        
        // Add tenants randomly
        secTenantID = RE_second_Tenant.getGlobal()
        thirdTenantID = RE_third_Tenant.getGlobal()
        TenantA = getSpecific(secTenantID)
        TenantB = getSpecific(thirdTenantID)
        
        If TenantA.isValid() 
            If Random(0,10) >= 9 && [[WHEN>=6 && WHEN<=10] || [WHEN>=16 && WHEN<=23]]
                If TenantAClothingStyle == 2
                    TenantA.strip()
                ElseIf TenantAClothingStyle == 1
                    If TenantA.isMale()
                        TenantA.dressExcept(Outerwear, Top, Bottom, Foot, Headwear)
                    Else
                        // dressExcept produces ugly results for girls in version 3.17 at least
                        Random
                            TenantA.dress(Floral-Fiesta-Panty_1_F, Hot-Work-Bra_1_F)
                            TenantA.dress(You-Wanna-Play-Panty_1_F, Basic-Lingerie-Bra_1_F)
                            TenantA.dress(Angel-Secrets-Wool-Panties_1_F, Angel-Secrets-Brassiere_1_F)
                            TenantA.dress(Bella-Chic-Jacket_1_F, Bella-Chic-Bra_1_F)
                            TenantA.dress(Burlesque-Bustier_1_F, Burlesque-Bra_1_F)
                            TenantA.dress(Bikinis-Bottom_1_F, Angel-Secrets-Brassiere_1_F)
                            TenantA.dress(Flounce-Bikini-Bottom_1_F, Flounce-Bikini-Top_1_F)
                            TenantA.dress(Basic-Panty_1_F, Angel-Secrets-Brassiere_1_F)
                            TenantA.dress(FGHM-Panty_1_F, Cathy-Jo-Fashion-Bra_1_F)
                            TenantA.dress(FG-Panty_1_F, Jumpsuit-Halter-Bra_1_F)
                            TenantA.dress(Trident-Bikini-Bottom_1_F, Bikinis-Top_1_F)
                            TenantA.dress(Hongyu-Pantie_1_F, Basic-Bra_1_F)
                            TenantA.dress(Passion-Touch-Lingerie-Shorts_1_F, Passion-Touch-Lingerie-Top_1_F)
                            TenantA.dress(Pure-Chance-Panties_1_F, Oot-Shade-Lingerie-Bra_1_F)
                            TenantA.dress(Nf-Panty_1_F, Powerage-Bra_1_F)
                        EndRandom
                    EndIf
                Else
                    If TenantA.isNaked()
                        TenantA.dress()
                    EndIf
                EndIf
                TenantA.setNoRedress(true)
                TenantA.addToPeopleHere()
            Else
                TenantA.hide()
                TenantA.saveAndDelete()
            EndIf
        EndIf
        
        If TenantB.isValid() 
            If Random(0,10) >= 9 && [[WHEN>=6 && WHEN<=10] || [WHEN>=16 && WHEN<=23]]
                If TenantBClothingStyle == 2
                    TenantB.strip()
                ElseIf TenantBClothingStyle == 1
                    If TenantB.isMale()
                        TenantB.dressExcept(Outerwear, Top, Bottom, Foot, Headwear)
                    Else
                        // dressExcept produces ugly results for girls in version 3.17 at least
                        Random
                            TenantB.dress(Floral-Fiesta-Panty_1_F, Hot-Work-Bra_1_F)
                            TenantB.dress(You-Wanna-Play-Panty_1_F, Basic-Lingerie-Bra_1_F)
                            TenantB.dress(Angel-Secrets-Wool-Panties_1_F, Angel-Secrets-Brassiere_1_F)
                            TenantB.dress(Bella-Chic-Jacket_1_F, Bella-Chic-Bra_1_F)
                            TenantB.dress(Burlesque-Bustier_1_F, Burlesque-Bra_1_F)
                            TenantB.dress(Bikinis-Bottom_1_F, Angel-Secrets-Brassiere_1_F)
                            TenantB.dress(Flounce-Bikini-Bottom_1_F, Flounce-Bikini-Top_1_F)
                            TenantB.dress(Basic-Panty_1_F, Angel-Secrets-Brassiere_1_F)
                            TenantB.dress(FGHM-Panty_1_F, Cathy-Jo-Fashion-Bra_1_F)
                            TenantB.dress(FG-Panty_1_F, Jumpsuit-Halter-Bra_1_F)
                            TenantB.dress(Trident-Bikini-Bottom_1_F, Bikinis-Top_1_F)
                            TenantB.dress(Hongyu-Pantie_1_F, Basic-Bra_1_F)
                            TenantB.dress(Passion-Touch-Lingerie-Shorts_1_F, Passion-Touch-Lingerie-Top_1_F)
                            TenantB.dress(Pure-Chance-Panties_1_F, Oot-Shade-Lingerie-Bra_1_F)
                            TenantB.dress(Nf-Panty_1_F, Powerage-Bra_1_F)
                        EndRandom
                    EndIf
                Else
                    If TenantB.isNaked()
                        TenantB.dress()
                    EndIf
                EndIf
                TenantB.setNoRedress(true)
                TenantB.addToPeopleHere()
            Else
                TenantB.hide()
                TenantB.saveAndDelete()
            EndIf
        EndIf
    EndIf
    
    