WHAT: all
WHERE: prison
WHEN: 10 - 18
WHO: none
OTHER: none

    SceneStart()
    
        Hunger = Player.getActorVar(rk_VB_Hunger)
        HungerEnable = rk_VB_EnableHunger.getGlobal()
        UrgeToPeeEnable = rk_VB_UrgeToPeeEnable.getGlobal()
        UrgeToPee = Player.getActorVar(rk_VB_UrgeToPee)
        preferentialtreatment = Player.getActorVar(rk_VB_preferentialtreatment)
        BadSexInPrison = Player.getActorVar(rk_VB_BadSexInPrison)
        // A scene for asking to get a mercy.... to have sentense be lowered....
        LastTimeAsked = Player.getActorVar(rk_VB_LastReduceSentence)  // got it
        LastTimeAskedM = Player.getActorVar(rk_VB_LastReduceSentenceM) //miss
        PlayerAge = Player:age*365
        TotalDayP = PlayerAge - LastTimeAsked
        AskedDToReduce = rk_VB_AskedDToReduceS.getGlobal()
        // List of charges
        BestiCount = Player.getActorVar(rk_VB_BestiCount)
        SellDrugCount = Player.getActorVar(rk_VB_SellDrugCount)
        IncestCount = Player.getActorVar(rk_VB_IncestCount)
        PublicIndCount = Player.getActorVar(rk_VB_PublicIndCount)
        KillCount = Player.getActorVar(rk_VB_KillCount)
        ProstCount = Player.getActorVar(rk_VB_ProstCount)
        RapeCount = Player.getActorVar(rk_VB_RapeCount)
        RobberyCount = Player.getActorVar(rk_VB_RobberyCount)
        SmallOffenceCount = Player.getActorVar(rk_VB_SmallOffenceCount)
        // Calcul for sentences
        TotalSentences = Player.getActorVar(rk_VB_TotalSentences)
        ActualSent = Player:sentence
        Player.setActorVar(rk_VB_TotalSentences, ActualSent)
        TotalSentences = Player.getActorVar(rk_VB_TotalSentences)
        DateofSentences = Player.getActorVar(rk_VB_DateofSentences)
        TotalDayPDS = PlayerAge - DateofSentences
        HalfDivActual = TotalSentences/2
        ThirdDivActual = TotalSentences/3
        QuatDivActual = TotalSentences/4
        If TotalSentences > 12 && DateofSentences > 1
            "Should I ask to see the prison warden for reducing my sentence?"
            0::"Yes"
            1::"No"
        
            If 0
                Guard2 = generatePersonTemporary()
                DirectorP = generatePerson()
                DirectorP.hide()
                Guard2.hide()
                Guard2.dressUniform(Police)
                "I ask the prison guard if I can talk to the prison warden ..."
                Guard2.show()
                DHaveTime = Random(0,100)
                Guard2(Serene)::"Let me check if you're available first ..."
                Guard2.animate(browse)
                Guard2(Serene)::"Okay, I see you are available to make a request to the prison warden. Let me check if <DirectorP.he_or_she> can see you in <DirectorP.his_or_her> office ..."
                Guard2.animate(socialize)
                If DHaveTime > 50 
                    If TotalSentences > 1000
                        DaysGiven = Random(1, 50)
                        DaysGiven = DaysGiven.round()
                    Elseif TotalSentences > 100
                        DaysGiven = Random(1, 30)
                        DaysGiven = DaysGiven.round()
                    Elseif TotalSentences > 30
                        DaysGiven = Random(1, 10)
                        DaysGiven = DaysGiven.round()
                    Else
                        DaysGiven = 0
                    Endif
                    Guard2(Serene)::"Follow me! I'll take you to the prison director, <DirectorP.he_or_she> agreed to meet you ..."
                    "Great, the prison warden accepted to see me!"
                    setBackground3D(Modules/rk_vin_Base/World/rk_VB_WaitRoom.lpworld)
                    "The guard takes me to a waiting room ..."
                    "After a while ..."
                    passTime(0.15, 0.45)
                    DirectorP(Serene)::"NEXT ..."
                    Guard2.animate()
                    setBackground3D(Modules/rk_vin_Base/World/rk_VB_PrisonOffice.lpworld)
                    Guard2.hide()
                    "Ok, it's my turn! Once I enter <DirectorP.his_or_her> office, the door closed and locked automatically ..."
                    DirectorP.show()
                    DirectorP.dressFormal()
                    DirectorP.animate(socialize)
                    DirectorP(Serene)::"Hi <Player.Mr_or_Miss> <Player.name>, what can I do for you today?"
                    Player(Curious)::"I would like you to reduce my sentence, if it's possible ..."
                    If [DirectorP.isInterestedIn(Player) && TotalDayP >= 92] || [DirectorP.isInterestedIn(Player) && DateofSentences >= 92]
                        Player.setActorVar(rk_VB_LastReduceSentence, PlayerAge)
                        DirectorP(Grin)::"3 month has passed since your last request! Let me look at your prisoner report!"
                        If TotalSentences < 15
                            DirectorP(Grin)::"Your prisoner report does not mention anything wrong and also your sentence will end soon. So no need to reduce your sentence even more ..."
                            SentEndSoon = true
                        Else
                            DirectorP(Grin)::"Your prisoner report does not mention any incident so I will reduce your sentence by <DaysGiven> day(s)."
                            sentence -= DaysGiven
                            sentenceP = Player:sentence
                            Player.setActorVar(rk_VB_TotalSentences, sentenceP)
                            "Do I should offer sex to reduce my sentence even more?"
                            0::"Yes"
                            1::"No"
                        
                            If 0
                                DirectorP.animate()
                                TotalSentences = Player.getActorVar(rk_VB_TotalSentences)
                                perversion += 1
                                If DirectorP:arousal > 15
                                    DirectorP(Grin)::"Sure!"
                                    DirectorP.strip()
                                    Player.strip()
                                    sexNoAffair(Player, DirectorP)
                                    If HungerEnable > 0
                                        Player.modifyActorVar(rk_VB_Hunger, -2)
                                    EndIf
                                    energy -= 10
                                    DaysGivenB = Random(0, 3)
                                    DaysGivenB = DaysGiven.round()
                                    BDGB = DaysGivenB + (Player:attractiveness/100)
                                    BDGB = BDGB.round()
                                    TBDGB = TotalSentences - BDGB
                                    If TotalSentences <= 0
                                        sentence => 0
                                        Player.setActorVar(rk_VB_TotalSentences, 0)
                                    Else
                                        sentence -= TBDGB
                                        Player.setActorVar(rk_VB_TotalSentences, TBDGB)
                                    Endif
                                    If DaysGivenB >= 1
                                        DirectorP(Grin)::"That was good! As a bonus, I will reduce your sentence by <DaysGiven> day(s)."
                                    Else
                                        DirectorP(Grin)::"That was good! But not enough to make me reduce your sentence even more."
                                    Endif
                                    DirectorP.dress()
                                    Player.dressPrisoner()
                                    passTime(0.5, 1.5)
                                Else
                                    DirectorP(Grin)::"Nice try, but I'm not in the mood for sex ..."
                                Endif
                            Endif
                        Endif
                    Elseif DirectorP.isInterestedIn(Player) && [TotalDayP >= 30 && TotalDayP <= 91.8] && DateofSentences >= 30
                        DirectorP(Grin)::"At least, 1 month has passed since your last request! Let me look at your prisoner report!"
                        If TotalSentences < 15
                            DirectorP(Grin)::"Your prisoner report does not mention anything wrong and also your sentence will end soon. Also it's too early to reduce your sentence even more ..."
                        Else
                            DirectorP(Grin)::"Your prisoner report does not mention anything wrong. Also it's too early to reduce your sentence even more ..."
                        Endif
                        Player.setActorVar(rk_VB_LastReduceSentenceM, 0.5)
                        "I have to wait at least a day before reapplying ..."
                        "I think I will wait a little more ..."
                        SentEndSoon = true
                    Else
                        DirectorP(Serene)::"Sorry, I have no reason to reduce your sentence ... Come back another time!"
                        Player.setActorVar(rk_VB_LastReduceSentenceM, 0.5)
                        "I have to wait at least a day before reapplying ..."
                        "I think I will wait a little more ..."
                        SentEndSoon = true
                        mood -= 5
                    Endif
                Else
                    Guard2(Serene)::"Sorry but the prison warden doesn't have time for you right now ..."
                    Player.setActorVar(rk_VB_LastReduceSentenceM, 0.5)
                    "I have to wait at least a day before reapplying ..."
                    "I think I will wait a little more ..."
                    mood -= 3
                Endif
                If SentEndSoon && DirectorP:arousal > 15
                    DirectorP(Flirty)::"But, if you're here to let me play with your body, maybe I'll give you a bonus?"
                    "What should I do?"
                    0::"Accept <DirectorP.his_or_her> offer"
                    1::"Don't accept <DirectorP.his_or_her> offer"
                    
                    If 0
                        SexNorm = true
                        NormalSex = false
                        If DirectorP:perversion > 50
                            DirectorP(Flirty)::"I like to try the things my prisoner likes to do with their victim, so according to your prisoner report I can see that you like ..."
                            
                            "What would I like to do with <DirectorP.him_or_her>?"
                            0::BestiCount > 0 && isModEnabled(vin_Bestiality)::"Bestiality sex"
                            1::SellDrugCount > 0 ::"Fuck <DirectorP.him_or_her> while I'm stoned"
                            2::PublicIndCount > 0 ::"Public sex"
                            3::KillCount > 0 ::"Aggressive sex"
                            4::ProstCount > 0 ::"Sex for money"
                            5::RapeCount > 0 && isModEnabled(vin_NonConsensual)::"Getting raped by <DirectorP.him_or_her>"
                            6::RobberyCount > 0 ::"Be punished for stealing"
                            99::SmallOffenceCount > 0 || SexNorm ::"Just normal sex"
                            
                            If 0
                                doggyP = generateCreatureTemporary(Dog)
                                doggyP.hide()
                                "The prison warden open a door and a dog came out from it"
                                doggyP.show()
                                DirectorP(Happy)::"I present to you my ultra horny dog, <doggyP.name>!"
                                "We stripped, <DirectorP.he_or_she> started to caressing me and the dog ready to play ..."
                                perversion += 1
                                DirectorP.strip()
                                Player.strip()
                                sexNoAffair(DirectorP, Player, doggyP)
                                If HungerEnable > 0
                                    Player.modifyActorVar(rk_VB_Hunger, -3)
                                EndIf
                                energy -= 10
                                DirectorP:rapportwithplayer += Random(0, 1)
                                If Player:attractiveness > 75 && Random(0,100) >= 50
                                    DaysGivenB = Random(1, 3)
                                Endif
                                doggyP.hide()
                            Elseif 1
                                "He gives me a pill and asks me to swallow it ... which I do immediately ... "
                                arousal += 50
                                perversion += 50
                                intoxication += 50
                                energy += 50
                                "The effect is instantaneous, I am completely stoned and horny like a rabbit, I am all yes .."
                                "We stripped and <DirectorP.he_or_she> started to caressing me ..."
                                DirectorP.strip()
                                Player.strip()
                                StonedFuck = true
                                sexNoAffair(DirectorP, Player)
                                While Player:energy > 10 && StonedFuck
                                    0::"Do it again"
                                    1::"Stop doing sex"
                                    
                                    If 0
                                        sexNoAffair(DirectorP, Player)
                                        If HungerEnable > 0
                                            Player.modifyActorVar(rk_VB_Hunger, -2)
                                        EndIf
                                        energy -= 10
                                        arousal -= 10
                                        intoxication -= 10
                                        perversion -= 10
                                    Else
                                        StonedFuck = false
                                    EndIf
                                EndWhile
                                energy -= 10
                                arousal -= 10
                                intoxication -= 10
                                perversion -= 10
                                DirectorP:rapportwithplayer += Random(0, 1)
                                If Player:attractiveness > 75 && Random(0,100) >= 60
                                    DaysGivenB = Random(0, 1)
                                Endif
                            Elseif 2
                                Guard3 = generatePersonTemporary()
                                Guard3.dressUniform(Police)
                                Inmate1 = generatePersonTemporary()
                                Inmate2 = generatePersonTemporary()
                                Inmate3 = generatePersonTemporary()
                                Inmate4 = generatePersonTemporary()
                                Inmate5 = generatePersonTemporary()
                                If Player.isMale()
                                    While Inmate1.isMale()
                                        Inmate1 = generatePersonTemporary()
                                    EndWhile
                                    While Inmate2.isMale()
                                        Inmate2 = generatePersonTemporary()
                                    EndWhile
                                    While Inmate3.isMale()
                                        Inmate3 = generatePersonTemporary()
                                    EndWhile
                                    While Inmate4.isMale()
                                        Inmate4 = generatePersonTemporary()
                                    EndWhile
                                    While Inmate5.isMale()
                                        Inmate5 = generatePersonTemporary()
                                    EndWhile
                                Else
                                    While !Inmate1.isMale()
                                        Inmate1 = generatePersonTemporary()
                                    EndWhile
                                    While !Inmate2.isMale()
                                        Inmate2 = generatePersonTemporary()
                                    EndWhile
                                    While !Inmate3.isMale()
                                        Inmate3 = generatePersonTemporary()
                                    EndWhile
                                    While !Inmate4.isMale()
                                        Inmate4 = generatePersonTemporary()
                                    EndWhile
                                    While !Inmate5.isMale()
                                        Inmate5 = generatePersonTemporary()
                                    EndWhile
                                Endif
                                Inmate1.dressPrisoner()
                                Inmate2.dressPrisoner()
                                Inmate3.dressPrisoner()
                                Inmate4.dressPrisoner()
                                Inmate5.dressPrisoner()
                                DirectorP.animate(call)
                                "The prison director makes a call and suddenly a guard and 5 prisoners walk into the prison director's office and ..."
                                Guard3.show()
                                Inmate1.show()
                                Inmate2.show()
                                Inmate3.show()
                                Inmate4.show()
                                Inmate5.show()
                                DirectorP.animate(socialize)
                                DirectorP(Happy)::"You like to do this in public, so strip down and let's fuck in front of our dear friends here."
                                "We stripped and <DirectorP.he_or_she> started to caressing me ..."
                                perversion += 1
                                DirectorP.strip()
                                Player.strip()
                                sexNoAffair(DirectorP, Player)
                                If HungerEnable > 0
                                    Player.modifyActorVar(rk_VB_Hunger, -2)
                                EndIf
                                energy -= 10
                                Guard3(Curious)::"<DirectorP.Sir_or_Madam>, my prisoners would like to join ... To be honest, me too!"
                                "What should I say?"
                                0::"It's ok for me"
                                1::"No way"
                                
                                If 0
                                    "All inmates started to undressed and the guard decided to be first to fuck with me ..."
                                    Guard3.strip()
                                    Inmate1.strip()
                                    Inmate2.strip()
                                    Inmate3.strip()
                                    Inmate4.strip()
                                    Inmate5.strip()
                                    Inmate1.animate(masturbate)
                                    Inmate2.animate(masturbate)
                                    Inmate3.animate(masturbate)
                                    Inmate4.animate(masturbate)
                                    Inmate5.animate(masturbate)
                                    sexNoAffair(Guard3, Player)
                                    If HungerEnable > 0
                                        Player.modifyActorVar(rk_VB_Hunger, -2)
                                    EndIf
                                    "I will do a threesome with two inmates ..."
                                    Inmate1.animate()
                                    Inmate2.animate(masturbate)
                                    Inmate3.animate()
                                    Inmate4.animate(masturbate)
                                    Inmate5.animate(masturbate)
                                    sexNoAffair(Inmate1, Player, Inmate3)
                                    If HungerEnable > 0
                                        Player.modifyActorVar(rk_VB_Hunger, -3)
                                    EndIf
                                    "I will do a foursome with three inmates ..."
                                    Inmate1.animate(masturbate)
                                    Inmate2.animate()
                                    Inmate3.animate(masturbate)
                                    Inmate4.animate()
                                    Inmate5.animate()
                                    sexNoAffair(Inmate2, Player, Inmate4, Inmate5)
                                    If HungerEnable > 0
                                        Player.modifyActorVar(rk_VB_Hunger, -4)
                                    EndIf
                                Else
                                    If RapeCount >= 1 && DirectorP:masochist < 0 && Guard3:masochist < 0
                                        DirectorP(Evil)::"Shut up!"
                                        Guard3(Grin)::"You are what you eat my friend, you will endure the same as your victims ..."
                                        Guard3.strip()
                                        Inmate1.strip()
                                        Inmate2.strip()
                                        Inmate3.strip()
                                        Inmate4.strip()
                                        Inmate5.strip()
                                        Inmate1.animate(masturbate)
                                        Inmate2.animate(masturbate)
                                        Inmate3.animate(masturbate)
                                        Inmate4.animate(masturbate)
                                        Inmate5.animate(masturbate)
                                        Filter(Aggressive)
                                        TalkNonConsensual()
                                        sexNoAffair(DirectorP, Player)
                                        If HungerEnable > 0
                                            Player.modifyActorVar(rk_VB_Hunger, -2)
                                        EndIf
                                        DirectorP(Happy)::"Next ..."
                                        Filter(Aggressive)
                                        TalkNonConsensual()
                                        sexNoAffair(Guard3, Player)
                                        If HungerEnable > 0
                                            Player.modifyActorVar(rk_VB_Hunger, -2)
                                        EndIf
                                        Guard3(Happy)::"Next ..."
                                        Inmate1.animate()
                                        Inmate2.animate(masturbate)
                                        Inmate3.animate(masturbate)
                                        Inmate4.animate(masturbate)
                                        Inmate5.animate(masturbate)
                                        Filter(Aggressive)
                                        TalkNonConsensual()
                                        sexNoAffair(Inmate1, Player)
                                        If HungerEnable > 0
                                            Player.modifyActorVar(rk_VB_Hunger, -2)
                                        EndIf
                                        Inmate1(Happy)::"Next ..."
                                        Inmate1.animate(masturbate)
                                        Inmate2.animate()
                                        Inmate3.animate(masturbate)
                                        Inmate4.animate(masturbate)
                                        Inmate5.animate(masturbate)
                                        Filter(Aggressive)
                                        TalkNonConsensual()
                                        sexNoAffair(Inmate2, Player)
                                        If HungerEnable > 0
                                            Player.modifyActorVar(rk_VB_Hunger, -2)
                                        EndIf
                                        Inmate2(Happy)::"Next ..."
                                        Inmate1.animate(masturbate)
                                        Inmate2.animate(masturbate)
                                        Inmate3.animate()
                                        Inmate4.animate(masturbate)
                                        Inmate5.animate(masturbate)
                                        Filter(Aggressive)
                                        TalkNonConsensual()
                                        sexNoAffair(Inmate3, Player)
                                        If HungerEnable > 0
                                            Player.modifyActorVar(rk_VB_Hunger, -2)
                                        EndIf
                                        Inmate3(Happy)::"Next ..."
                                        Inmate1.animate(masturbate)
                                        Inmate2.animate(masturbate)
                                        Inmate3.animate(masturbate)
                                        Inmate4.animate()
                                        Inmate5.animate(masturbate)
                                        Filter(Aggressive)
                                        TalkNonConsensual()
                                        sexNoAffair(Inmate4, Player)
                                        If HungerEnable > 0
                                            Player.modifyActorVar(rk_VB_Hunger, -2)
                                        EndIf
                                        Inmate4(Happy)::"Next ..."
                                        Inmate1.animate(masturbate)
                                        Inmate2.animate(masturbate)
                                        Inmate3.animate(masturbate)
                                        Inmate4.animate(masturbate)
                                        Inmate5.animate()
                                        Filter(Aggressive)
                                        TalkNonConsensual()
                                        sexNoAffair(Inmate5, Player)
                                        If HungerEnable > 0
                                            Player.modifyActorVar(rk_VB_Hunger, -2)
                                        EndIf
                                        Inmate5(Happy)::"That was good ..."
                                        energy -= 25
                                        arousal -= 20
                                        perversion -= 25
                                        mood -= 50
                                    Else
                                        DirectorP(Sad)::"No time for that today, my friend! I got a lot of work to do ..."
                                        Guard3(Grin)::"Alright boss!"
                                    Endif
                                Endif
                                Guard3.hide()
                                Inmate1.hide()
                                Inmate2.hide()
                                Inmate3.hide()
                                Inmate4.hide()
                                Inmate5.hide()
                                DirectorP:rapportwithplayer += Random(0, 1)
                                If Player:attractiveness > 75 && Random(0,100) >= 50
                                    DaysGivenB = Random(1, 3)
                                Endif
                            Elseif 3 || 5
                                DirectorP(Happy)::"So, you like it hard! No problem ..."
                                DirectorP(Evil)::"Strip right away and do all I ask!"
                                Player.strip()
                                Player(Scared)::"Yes master ..."
                                DirectorP.strip()
                                Filter(Aggressive)
                                TalkNonConsensual()
                                sexNoAffair(DirectorP, Player)
                                energy -= 10
                                If HungerEnable > 0
                                    Player.modifyActorVar(rk_VB_Hunger, -3)
                                EndIf
                                If Player:attractiveness > 75 && Random(0,100) >= 80
                                    DaysGivenB = Random(0, 1)
                                Endif
                            Elseif 4 || 6
                                DirectorP(Curious)::"Well as I saw, you're the kind of person who steals or sells his ass for money or to make ends meet ..."
                                DirectorP(Flirty)::"Let see if you're giving good sex ..."
                                perversion += 1
                                DirectorP.strip()
                                Player.strip()
                                "We stripped and <DirectorP.he_or_she> started to caressing me ..."
                                sexNoAffair(DirectorP, Player)
                                If HungerEnable > 0
                                    Player.modifyActorVar(rk_VB_Hunger, -2)
                                EndIf
                                energy -= 10
                                DirectorP:rapportwithplayer += Random(0, 1)
                                If Player:attractiveness > 75 && Random(0,100) >= 40
                                    DaysGivenB = Random(0, 1)
                                    DaysGivenB.round()
                                    If DaysGivenB <= 0
                                        DGCash = Random(50, 200)
                                        DGCash_loc = DGCash.convertToLocalCurrency()
                                        "The prison warden gave me <DGCash_loc> because I fucked with <DirectorP.him_or_her>"
                                        money += DGCash
                                    Endif
                                Endif
                            Elseif 99
                                "We stripped and <DirectorP.he_or_she> started to caressing me ..."
                                perversion += 1
                                DirectorP.strip()
                                Player.strip()
                                sexNoAffair(DirectorP, Player)
                                If HungerEnable > 0
                                    Player.modifyActorVar(rk_VB_Hunger, -2)
                                EndIf
                                energy -= 10
                                DirectorP:rapportwithplayer += Random(0, 1)
                                If Player:attractiveness > 75 && Random(0,100) >= 60
                                    DaysGivenB = 1
                                Endif
                            Endif
                        Endif
                        BDGB = DaysGivenB + (Player:attractiveness/100)
                        BDGB = BDGB.round()
                        TBDGB = TotalSentences - BDGB
                        If TotalSentences <= 0
                            sentence => 0
                            Player.setActorVar(rk_VB_TotalSentences, 0)
                        Else
                            sentence -= TBDGB
                            Player.setActorVar(rk_VB_TotalSentences, TBDGB)
                        Endif
                        If DaysGivenB >= 1
                            DirectorP(Grin)::"That was good! As a bonus, I will reduce your sentence by <DaysGiven> day(s)."
                        Else
                            DirectorP(Grin)::"That was good! But not enough to make me reduce your sentence even more."
                        Endif
                        DirectorP.dress()
                        Player.dressPrisoner()
                        passTime(0.5, 1.5)
                    Else
                        DirectorP(Angry)::"Go back to your cell you're wasting my time..."
                        DirectorP.animate()
                        DirectorP:rapportwithplayer -= Random(0, 3)
                    Endif
                Endif 
                DirectorP(Angry)::"GUARD ... Please take this prisoner back to <Player.his_or_her> cell."
                Guard2.show()
                Guard2(Serene)::"Right away, <DirectorP.sir_or_madam>!"
                DirectorP.hide()
                "The guard took me back to my cell."
                Guard2.hide()
                passTime(0.15, 0.25)
            Else
                "I think I will wait a little more ..."
            Endif
            If TotalSentences <= 0
                followUp(released_from_prison)
            Endif
        Else
            If TotalSentences > 14.9
                "It's too early to ask something to the prison warden ..."
            Else
                "I will be released in few days! So I don't need to talk to the prison warden ..."
            Endif
        Endif
        If TotalSentences <= 0
            followUp(released_from_prison)
        Endif
    SceneEnd()