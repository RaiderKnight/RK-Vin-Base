WHAT: all
WHERE: nightclub, bar, pub, biergarten, stripclub
WHEN: 2-4
WHO: none
OTHER: Random(0, 100) < 95

    SceneStart()
        Hunger = Player.getActorVar(rk_VB_Hunger)
        HungerEnable = rk_VB_EnableHunger.getGlobal()
        UrgeToPeeEnable = rk_VB_UrgeToPeeEnable.getGlobal()
        UrgeToPee = Player.getActorVar(rk_VB_UrgeToPee)
        If !BarOwner.isValid()
            BarOwner = generatePersonTemporary()
            While BarOwner.isInterestedIn(Player)
                BarOwner = generatePersonTemporary()
            Endwhile  
            BarOwner.makePermanent()
        Else
            Emplo = BarOwner.isEmployee()
            BarOwner = getPersonHere(Emplo)
        Endif
        Actor = generatePersonTemporary()
        While Actor.isInterestedIn(Player)
            Actor = generatePersonTemporary()
        Endwhile
        Actor.makePermanent()
        Actor.hide()
        Actor1 = generatePersonTemporary()
        While Actor1.isInterestedIn(Player)
            Actor1 = generatePersonTemporary()
        Endwhile
        Actor1.makePermanent()
        Actor1.hide()
        Actor2 = generatePersonTemporary()
        While Actor2.isInterestedIn(Player)
            Actor2 = generatePersonTemporary()
        Endwhile
        Actor2.makePermanent()
        Actor2.hide()
        BarOwner.dress()
        BarOwner.show()
        BarOwner.animate(socialize)
        If WHEN >= 2 && WHEN <= 3
            BarOwner(Happy)::"LAST CALL EVERYBODY! We close in 2 hours!"
        Elseif WHEN >= 3.1 && WHEN <= 3.9
            BarOwner(Happy)::"LAST CALL EVERYBODY! We close in 1 hour!"
        Elseif WHEN >= 4
            BarOwner(Happy)::"We are now closed! See you later tonight ..."   
        Endif
        If Random(0, 100) < Actor:interpersonal || [isWithCompanion() && Random(0, 200) < Actor:interpersonal]
            Actor.dress()
            Actor.show()
            Actor.moveToPersonStand(Player, 50)
            Actor(Flirty)::"Hi, can I get your phone number? It would be great to do something together one day ..."
            0:: "Yes"
            1:: "No"
            
            If 0
                exchangeContact(Actor)
                "I happily accepted. We exchanged numbers and went our separate ways."
            Else
                "I found an excuse not to give <Actor.him_or_her> my number. Disappointed, <Actor.he_or_she> left."
            Endif
            
        Elseif Actor1:arousal > 25 && Random(75, 300) < attractiveness
            Actor1.dress()
            Actor1.show()
            Actor1.moveToPersonStand(Player, 50)
            Actor1(Flirty):: "Oh my God, you are the hottest <Player.guy_or_girl> I ever seen!"
            "Wow, that's quite a direct pickup line ..."
            "Seemingly driven out of <Actor1.his_or_her> mind by my attractiveness, the stranger is offering me to fuck <Actor1.him_or_her> ..."
            0:: "Agree to fuck <Actor1.name>"
            1:: "No deal!"
            
            If 0
                setBackground(home)
                "Soon enough I followed <Actor1.name> back to <Actor1.his_or_her> home"
                "Once we arrived, we stripped and started to have sex ..."
                Actor1.strip()
                Player.strip()
                Sex(Player, Actor1)
                If HungerEnable > 0
                    Player.modifyActorVar(rk_VB_Hunger, -2)
                EndIf
                perversion += 1
                "<Actor1.name> suggested that we exchange contacts. Shall I?"
                0:: "Yes"
                1:: "No"
                
                If 0
                    exchangeContact(Actor1)
                    "I happily accepted. We exchanged numbers and went our separate ways."
                Else
                    "I found an excuse not to give <Actor1.him_or_her> my number. Disappointed, <Actor1.he_or_she> left."
                Endif
                If !wasCondomUsedDuringLastSex() && Random(0,100)<=3
                    contactSTD()
                    "Oh no, I have a STD."
                EndIf
                "We then returned to the where we were ..."
            Else
                "I found an excuse to not fuck with <Actor1.him_or_her>. Disappointed, <Actor1.he_or_she> left."
            Endif
        Else
            Actor.dress()
            Actor2.dress()
            Actor.show()
            Actor2.show()
            Actor.makeInterested(Actor2)
            Actor.moveToPersonStand(Player, 50)
            Actor2.moveToPersonStand(Player, 50)
            "I came across a couple, <Actor.name> and <Actor2.name>. Seems like decent people. They want to know if I'm interested for a threesome?"
            0:: "Yes"
            1:: "No"
            
            If 0
                setBackground(home)
                "Soon enough I followed <Actor.name> and <Actor2.name> back to their home"
                "Once we arrived, we stripped and started to have sex ..."
                Actor.strip()
                Actor2.strip()
                Player.strip()
                Sex(Actor, Player, Actor2)
                If HungerEnable > 0
                    Player.modifyActorVar(rk_VB_Hunger, -3)
                EndIf
                perversion += 1
                "<Actor2.name> suggested that we exchange contacts. Shall I?"
                0:: "Yes"
                1:: "No"
                
                If 0
                    exchangeContact(Actor)
                    "I happily accepted. We exchanged numbers and went our separate ways."
                    exchangeContact(Actor2)
                Else
                    "I found an excuse not to give them my number. Disappointed, they left."
                Endif
                If !wasCondomUsedDuringLastSex() && Random(0,100)<=3
                    contactSTD()
                    "Oh no, I have a STD."
                EndIf
            Else
                "I found an excuse to not fuck with them. Disappointed, they left."
            Endif
        Endif
        Actor.hide()
        Actor1.hide()
        Actor2.hide()
        BarOwner.hide()
    SceneEnd()
    timeout(0.5, rk_VB_LastCallPubBar)