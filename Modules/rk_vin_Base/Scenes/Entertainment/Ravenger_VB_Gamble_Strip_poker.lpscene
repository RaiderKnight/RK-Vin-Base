WHAT: gamble
WHERE: pub, hotel
WHEN: 0 - 24
WHO: none
OTHER: none

    sceneStart()

        Hunger = Player.getActorVar(rk_VB_Hunger)
        HungerEnable = rk_VB_EnableHunger.getGlobal()
        Host = generatePersonTemporary()
        "I approached a poker table too watch how they play." // Edit by Raddeck
        Host.dress()
        Host.show(1)
        Host():: "Greeting, you look like someone who likes to gamble."
        Host():: "Would you like to join me & my friends for a privat game of strippoker?" // Edit by Raddeck
        Guest1 = getCompanion()
        
        If Guest1.isCreature()
        
           endDate()
           
        Endif
       
        If !Guest1.isValid()
        
           Guest1 = generatePersonTemporary()
           
        Else
       
           Host():: "Your friend <Guest1.name> can also join."
           
        Endif
       
        0:: "Sure"
        1:: "No thanks"
       
        If 0
        
            setbackground(livingroom)
            Guest1.dress()
            "<Guest1.name> is here."
            Guest1.show(1)
        
            Guest2 = generatePersonTemporary()
            Guest2.dress()
            "<Guest2.name> showed up."
            Guest2.show(1)
        
            Guest3 = generatePersonTemporary()
            Guest3.dress()
            "<Guest3.name> came in."
            Guest3.show(1)
        
            Guest4 = generatePersonTemporary()
            Guest4.dress()
            "<Guest4.name> has arrived."
            Guest4.show(1)
        
            Guest5 = generatePersonTemporary()
            Guest5.dress()
            Host():: "Who are you?"
            Host():: "No one cares move along."
            Guest5.show(1)
        
            Host():: "Everyone is here now. The party has started!"
        
            money -= 100
            Pgold = 100
            G1gold = 100
            G2gold = 100
            G3gold = 100
            G4gold = 100
            G5gold = 100
            Hgold = 100
            P = true
            G1 = true
            G2 = true
            G3 = true
            G4 = true
            G5 = true
            H = true
            Host():: "We are playing Texas Holdem, not that it really matters."
            Host():: "100 rounds, buy in $100, wager $10 for each person, strip one piece of clothing for $100 money if you run out."
            Host():: "Max posible winnings $5,600, depending on amount of clothing for each person."
            Host():: "Don't worry if your out or game ends early, you will have plenty of time to chat it up with fellow losers."
            Rounds = 0
            Cheat = false
            Leave = false
            While Rounds < 100 && !Leave && !Cheat
                passTime(0.1)
                Rounds += 1
                player.show()
                Host.show(1)
                Guest5.show(1)
                Guest4.show(1)
                Guest3.show(1)
                Guest2.show(1)
                Guest1.show(1)
        
                If G1gold <= 0 && !Guest1.isnaked()
                    "<Guest1.name> stripped a piece of clothing."
                    Guest1.stripOne()
                    Guest1:perversion += 1
                    G1gold += 100
                Elseif G1gold <= 0 && Guest1.isnaked()
                    G1 = false
                else
                    "<Guest1.name> is still playing"
                Endif
        
                If G2gold <= 0 && !Guest2.isnaked()
                    "<Guest2.name> stripped a piece of clothing."
                    Guest2.stripOne()
                    Guest2:perversion += 1
                    G2gold += 100
                Elseif G2gold <= 0 && Guest2.isnaked()
                    G2 = false
                else
                    "<Guest2.name> is still playing"
                Endif    
            
                If G3gold <= 0 && !Guest3.isnaked()
                    "<Guest3.name> stripped a piece of clothing."
                    Guest3.stripOne()
                    Guest3:perversion += 1
                    G3gold += 100
                Elseif G3gold <= 0 && Guest3.isnaked()
                    G3 = false
                else
                    "<Guest3.name> is still playing"
                Endif    
            
                If G4gold <= 0 && !Guest4.isnaked()
                    "<Guest4.name> stripped a piece of clothing."
                    Guest4.stripOne()
                    Guest4:perversion += 1
                    G4gold += 100
                Elseif G4gold <= 0 && Guest4.isnaked()
                    G4 = false
                else
                    "<Guest4.name> is still playing"
                Endif    
            
                If G5gold <= 0 && !Guest5.isnaked()
                    "<Guest5.name> stripped a piece of clothing."
                    Guest5.stripOne()
                    Guest5:perversion += 1
                    G5gold += 100
                Elseif G5gold <= 0 && Guest5.isnaked()
                    G5 = false
                else
                    "<Guest5.name> is still playing"
                Endif    
            
                If Hgold <= 0 && !Host.isnaked()
                    "<Host.name> stripped a piece of clothing."
                    Host.stripOne()
                    Host:perversion += 1
                    Hgold += 100
                Elseif Hgold <= 0 && Host.isnaked()
                    "<Host.name> is no longer playing"
                    H = false
                else
                    "<Host.name> is still playing"
                Endif    
            
                If P && Pgold <= 0 && !Player.isnaked()
                    "<Player.name> stripped a piece of clothing."
                    Player.stripOne()
                    perversion += 1
                    Pgold += 100
                Elseif !P || Pgold <= 0 && Player.isnaked()
                    P = false
                else
                    "<Player.name> is still playing"
                Endif    
        
                Cost = Random(10, 50)
                Pot = 0
                If H
                    Hgold -= 10
                    Pot += 10
                Endif
                    
                If G1
                    G1gold -= 10
                    Pot += 10
                Endif
                    
                If G2
                    G2gold -= 10
                    Pot += 10
                Endif
                    
                If G3
                    G3gold -= 10
                    Pot += 10
                Endif
                    
                If G4
                    G4gold -= 10
                    Pot += 10
                Endif
                    
                If G5
                    G5gold -= 10
                    Pot += 10
                Endif        
                
                If P && [G1 || G2 || G3 || G4 || G5 || H]
                    Pgold -= 10
                    Pot += 10
                                                  
                    "How do you play. Winnings $<Pgold>"
                    0:: "Safe"
                    1:: "Risk"
                    2:: "Cheat -danger-"
                    3:: "Leave poker game."
                    4:: "Leave party"
                                                            
                    If 4
                        Leave = true
                        If G1 && G2 && G3 && G4 && G5 && H
                            "What are chicken? Leaving already?"
                        Endif
                    Else
                        If 0
                            If 5 > Random(0, 38)
                                Pgold += Pot
                                "I won."
                            Else
                                If H && 5 > Random(0, 38)
                                    Hgold += Pot
                                Elseif G1 && 5 > Random(0, 38)
                                    G1gold += Pot
                                Elseif G2 && 5 > Random(0, 38)
                                    G2gold += Pot
                                Elseif G3 && 5 > Random(0, 38)
                                    G3gold += Pot
                                Elseif G4 && 5 > Random(0, 38)
                                    G4gold += Pot
                                Elseif G5 && 5 > Random(0, 38)
                                    G5gold += Pot
                                Elseif intelligence > Random(0, 101)   
                                    Pgold += Pot
                                    "I won."
                                Elseif H && Host:intelligence > Random(0, 100)
                                    Hgold += Pot
                                Elseif G1 && Guest1:intelligence > Random(0, 100)
                                    G1gold += Pot
                                Elseif G2 && Guest2:intelligence > Random(0, 100)
                                    G2gold += Pot
                                Elseif G3 && Guest3:intelligence > Random(0, 100)
                                    G3gold += Pot
                                Elseif G4 && Guest4:intelligence > Random(0, 100)
                                    G4gold += Pot
                                Else
                                    G5gold += Pot
                                Endif
                            Endif                       
                                                         
                        Elseif 1
                            Pgold -= Cost
                            Pot += Cost
                            If H
                                Hgold -= Cost
                                Pot += Cost
                            Endif
                            
                            If G1
                                G1gold -= Cost
                                Pot += Cost
                            Endif
                            
                            If G2
                                G2gold -= Cost
                                Pot += Cost
                            Endif
                            
                            If G3
                                G3gold -= Cost
                                Pot += Cost
                            Endif
                            
                            If G4
                                G4gold -= Cost
                                Pot += Cost
                            Endif
                            
                            If G5
                                G5gold -= Cost
                                Pot += Cost
                            Endif
                                                         
                            If 5 > Random(0, 38)
                                Pgold += Pot
                                "I won."
                            Elseif [intelligence + interpersonal] > Random(0, 300)   
                                Pgold += Pot
                                "I won."                    
                            Else
                                If H && 5 > Random(0, 38)
                                    Hgold += Pot
                                Elseif G1 && 5 > Random(0, 38)
                                    G1gold += Pot
                                Elseif G2 && 5 > Random(0, 38)
                                    G2gold += Pot
                                Elseif G3 && 5 > Random(0, 38)
                                    G3gold += Pot
                                Elseif G4 && 5 > Random(0, 38)
                                    G4gold += Pot
                                Elseif G5 && 5 > Random(0, 38)
                                    G5gold += Pot
                                Elseif H && Host:intelligence > Random(0, 100)
                                    Hgold += Pot
                                Elseif G1 && Guest1:intelligence > Random(0, 100)
                                    G1gold += Pot
                                Elseif G2 && Guest2:intelligence > Random(0, 100)
                                    G2gold += Pot
                                Elseif G3 && Guest3:intelligence > Random(0, 100)
                                    G3gold += Pot
                                Elseif G4 && Guest4:intelligence > Random(0, 100)
                                    G4gold += Pot
                                Else
                                    G5gold += Pot
                                Endif
                            Endif
                                            
                        Elseif 2
                            Pgold -= Cost
                            Pot += Cost
                            If H
                                Hgold -= Cost
                                Pot += Cost
                            Endif
                            
                            If G1
                                G1gold -= Cost
                                Pot += Cost
                            Endif
                            
                            If G2
                                G2gold -= Cost
                                Pot += Cost
                            Endif
                            
                            If G3
                                G3gold -= Cost
                                Pot += Cost
                            Endif
                            
                            If G4
                                G4gold -= Cost
                                Pot += Cost
                            Endif
                            
                            If G5
                                G5gold -= Cost
                                Pot += Cost
                            Endif
                            SneakGame()
                            If Random(0, 150) < [sneak + karma]
                                Player(happy):: "Oh, 'Lucky me' I won."
                                Pgold += Pot
                                karma -= 1
                            Else
                                Host(angry):: "Wait a moment! Your cheating!"
                                Cheat = True
                                Guest1(angry):: "Cheating!"
                                Guest2(angry):: "We don't tolerate cheating!"
                                Guest3(angry):: "I'm from Texas where Cheater go to DIE!"
                                Guest4(angry):: "Everyone grab a gun!"
                                Guest5(angry):: "We Killing a Cheater to night!"
                                Host.animate(gun)
                                Guest1.animate(gun)
                                Guest2.animate(gun)
                                Guest3.animate(gun)
                                Guest4.animate(gun)
                                Guest5.animate(gun)
                                Player(scared):: "Note to self don't cheat at Texas Holdem with texans."
                                "-excessive gun fire-"
                                followUp(death)
                            Endif
                    
                        Else
                            If H && 5 > Random(0, 38)
                                Hgold += Pot
                            Elseif G1 && 5 > Random(0, 38)
                                G1gold += Pot
                            Elseif G2 && 5 > Random(0, 38)
                                G2gold += Pot
                            Elseif G3 && 5 > Random(0, 38)
                                G3gold += Pot
                            Elseif G4 && 5 > Random(0, 38)
                                G4gold += Pot
                            Elseif G5 && 5 > Random(0, 38)
                                G5gold += Pot
                            Elseif H && Host:intelligence > Random(0, 100)
                                Hgold += Pot
                            Elseif G1 && Guest1:intelligence > Random(0, 100)
                                G1gold += Pot
                            Elseif G2 && Guest2:intelligence > Random(0, 100)
                                G2gold += Pot
                            Elseif G3 && Guest3:intelligence > Random(0, 100)
                                G3gold += Pot
                            Elseif G4 && Guest4:intelligence > Random(0, 100)
                                G4gold += Pot
                            Else
                                G5gold += Pot
                            Endif
                            P = false                    
                            
                        Endif
                                  
                                
                    Endif
                                                 
                Else
                    "Since your no longer playing, what do you want to do?"
                    1:: !G1:: "Chat with <Guest1.name>"
                    2:: !G2:: "Chat with <Guest2.name>"
                    3:: !G3:: "Chat with <Guest3.name>"
                    4:: !G4:: "Chat with <Guest4.name>"
                    5:: !G5:: "Chat with <Guest5.name>"
                    6:: !H:: "Chat with <Host.name>"
                    7:: Pgold > 0 || !Player.isnaked():: "Rejoin game."
                    8:: "Leave"
                                       
                    If 8
                        Leave = true
                        If G1 && G2 && G3 && G4 && G5 && H
                            "You lost very badly a poker that you had to leave in shame."
                            mood -= 10 // Edit by Raddeck
                        Endif
                    Elseif 7
                        "Lets rejoin the game."
                        P = true
                    
                    Else
                        If 1
                            SitWith = Guest1
                        Elseif 2
                            SitWith = Guest2
                        Elseif 3
                            SitWith = Guest3
                        Elseif 4
                            SitWith = Guest4
                        Elseif 5
                            SitWith = Guest5
                        Else
                            SitWith = Host  
                        Endif
                                              
                        Guest1.hide()
                        Guest2.hide()
                        Guest3.hide()
                        Guest4.hide()
                        Guest5.hide()
                        Host.hide()        
                        SitWith.show(2)
                        "I spent some time chatting with <SitWith.name>"
                                   
                        interpersonal += 3
                        SitWith:interpersonal += 3
                                                  
                        If Player.isNaked() && SitWith.IsInterestedIn(Player) && [isModEnabled(vin_Incest) || !SitWith.isRelative()]
                            SitWith:arousal += 10
                        Endif
                                                 
                        If SitWith.IsInterestedIn(Player) && Random(0, 100) < attractiveness
                            SitWith:attractiontoplayer += Random(-1, 2)
                        Else
                            SitWith:rapportwithplayer += Random(-1, 2)
                        Endif
                                                          
                        If SitWith.IsInterestedIn(Player) && Random(0, 100) < interpersonal
                            SitWith:attractiontoplayer += 1
                        Else
                            SitWith:rapportwithplayer += 1
                        Endif
                                        
                        If !SitWith.isContactExchanged()
                            If SitWith.IsDominantSex(Player) || !SitWith.IsInterestedIn(Player)
                                SitWith(Happy):: "Hey, I just realized I didn't have your number. Do you mind ..."
                                0:: "Exchange contacts"
                                1:: "Sorry but no"
                                                                 
                                If 0
                                    Player(Excited):: "Of course! Let's exchange numbers!"
                                    exchangeContact(SitWith)
                                    SitWith:rapportwithplayer += Random(0, 5)
                                    passTime(0.1)
                                Else
                                    Player(Sad):: "I'm afraid I don't know you well enough yet for that."
                                    SitWith:rapportwithplayer -= Random(0, 3)
                                Endif
                                                                  
                            Else
                                "Should I ask <SitWith.name> for <SitWith.his_or_her> number?"
                                0:: "Ask for <SitWith.his_or_her> number"
                                1:: "Maybe not"
                                                         
                                If 0
                                    Player(Happy):: "You know what? Let's exchange numbers so that we can keep in touch after the party."
                                    If SitWith:attractiontoplayer > Random(0, 30) || SitWith:rapportwithplayer > Random(0, 30) || SitWith:intoxication > Random(50, 90)
                                        SitWith(Excited):: "Of course! Let's exchange numbers!"
                                        exchangeContact(SitWith)
                                        passTime(0.1)
                                    Else
                                        SitWith(Sad):: "I'm afraid I don't know you well enough yet for that. Maybe next time."
                                    Endif
                                Else
                                    "Not yet. I want to get to know <SitWith.name> a bit better first ..."
                                Endif
                            Endif

                        Else
                            "Shall we have a friendly conversation "    
                            0:: "Yes"
                            1:: "No"

                            If 0
                                passTime(0.1)
                                SitWith:rapportwithplayer += Random(-5, 10)
                                Player():: "How are you doing?"
                                If SitWith:rapportwithplayer > 50
                                    "We talked about family, work, & stuff."
                                Endif
                            Endif
                        Endif      

                        KissBack = false
               
                        If Player.IsInterestedIn(SitWith) && [isModEnabled(vin_Incest) || !SitWith.isRelative()]
                            "Should I flirt a bit with <SitWith.name>?"
                            0:: "Yes"
                            1:: "No"

                            If 0
                                SitWith:attractiontoplayer += 2
                                "I took every opportunity we had flirt with <SitWith.name>."
                                If [SitWith:attractiontoplayer + SitWith:arousal] > 50
                                    "They enjoy my company."
                                    SitWith:attractiontoplayer += 2
                                Endif
                                passTime(0.1)
                                If isModEnabled(vin_NonConsensual) && masochist < -30
                                    "Should I grope them?"
                                    0:: "Yes"
                                    1:: "No"

                                    If 0
                                        "I begin groping them."
                                        passTime(0.1)
                                        SitWith:perversion += 1
                                        SitWith:arousal += 5
                                        If SitWith:perversion > 35 || SitWith:arousal > 35 || masochist > 30
                                            "They don't seem to mind"
                                            SitWith:perversion += 1
                                            SitWith:arousal += 20
                                            SitWith:attractiontoplayer += 2
                                            If SitWith:masochist > 30
                                                "I think they enjoy it."
                                                SitWith:perversion += 2
                                            Endif
                                        Else
                                            "<SitWith.name> doesn't like you touching them."
                                            SitWith:arousal -= 10
                                        Endif        
                                    Endif          
                                Endif                        
                            Endif
                        Endif
                        Lust = 0
                        Lust += SitWith:perversion
                        Lust += SitWith:attractiontoplayer
                        Lust += SitWith:incest
                        Lust += SitWith:arousal
                        If SitWith.IsInterestedIn(Player) && SitWith:arousal > 85 || SitWith:incest > 75 || SitWith:attractiontoplayer > 75 || [intoxication > 70 && SitWith:perversion > 50] && [isModEnabled(vin_Incest) || !SitWith.isRelative()] 
                            If SitWith.IsDominantSex(Player) && Lust > Random(100, 200)
                                AnimatePair(Player, SitWith, Kissing)
                                "All of a sudden, <SitWith.name> grabbed me and leaned in for a kiss"
                                SitWith(Kiss):: "..."
                                0:: "Kiss back"
                                1:: "Turn <SitWith.him_or_her> down"
                                    
                                If 0
                                    KissBack = true
                                    passTime(0.1)
                                Else
                                    "I pulled myself away from <SitWith.him_or_her>. <SitWith.He_or_She> was visibly embarrassed."
                                    SitWith:attractiontoplayer -= Random(0, 1)
                                Endif
                                                       
                            Else 
                                "From the way <SitWith.name> was checking me out, I could tell that <SitWith.he_or_she> was totally into me. Should I make my move now and kiss <SitWith.him_or_her>?"
                                0:: "Kiss <SitWith.name>"
                                1:: "Maybe not"
                                    
                                If 0
                                    AnimatePair(Player, SitWith, Kissing)
                                    Player(Kiss):: "..."
                                    If Lust > Random(100, 200)
                                        SitWith(Kiss):: "..."
                                        "Wow, that's quite a pleasant surprise. <SitWith.name> was totally receptive to my advance. In fact, <SitWith.he_or_she> certainly showed that <SitWith.he_or_she> wanted something more ..."
                                        KissBack = true
                                        passTime(0.1)
                                    
                                    Else
                                        "<SitWith.name> pulled away from my advances. Embarrassed, I retreated, pretending for the rest of the party as if nothing happened ..."
                                    
                                    Endif
                                               
                                Else
                                    "Perhaps not ... It would be extremely embarrassing to be rejected in front of everyone."
                                       
                                Endif
                                                           
                            Endif
                                                 
                    
                        Elseif Player.IsInterestedIn(SitWith) && [isModEnabled(vin_Incest) || !SitWith.isRelative()]
                            "I'm totally into <SitWith.name>. Should I make my move now and kiss <SitWith.him_or_her>?"
                            0:: "Kiss <SitWith.name>"
                            1:: "Maybe not"
                                
                            If 0
                                AnimatePair(Player, SitWith, Kissing)
                                Player(Kiss):: "..."
                                If Lust > Random(100, 200)
                                    SitWith(Kiss):: "..."
                                    "<SitWith.name> was totally receptive to my advance."
                                    SitWith(flirty)::"I usually don't like <Player.men_or_women> at all, but there's something about you ... I can't help myself ..."
                                    KissBack = true
                                    passTime(0.1)
                                Else
                                    SitWith():: "Sorry, I'm not into <Player.men_or_women>."
                                Endif
                            Else
                                "Perhaps not ... It would be extremely embarrassing to be rejected in front of everyone."
                            Endif
                        Else
                            "....-Awkward silence-...."
                        Endif   
                
                        Saved = SitWith.getActorVar(tag_Saved)
                        If KissBack && Saved < 1 && [isModEnabled(vin_Incest) || !SitWith.isRelative()]
                            Player(Kiss):: "..."
                            "I responded in kind and we indulged ourselves in a passionate kiss."
                            SitWith:attractiontoplayer += 5
                            0:: "Take <SitWith.name> to bed"
                            1:: "Stop it there"
                                    
                            If 0 
                                "I needed to feel <SitWith.him_or_her> right here, right now."
                                "We dragged each other to the bedroom and started making out intensely. Things were escalating quickly ..."
                                perversion += 5
                                Sex(Player, SitWith)
                                SitWith.show(2)
                                passTime(0.3)
                                "The sex was amazing."
                                If HungerEnable > 0
                                    Player.modifyActorVar(rk_VB_Hunger, -1)
                                EndIf
                            Else
                                "I enjoyed the kiss but didn't feel like going any further ..."
                            Endif
                            
                        Endif
                        
                        SitWith.hide()
                        
                    Endif
                    
                Endif
                
            EndWhile
            
            "Winnings $<Pgold>"
            money += Pgold 
            If HungerEnable > 0
                Player.modifyActorVar(rk_VB_Hunger, -2)
            EndIf            
            endDate()
           
        Else
        
           "No thank you"
           
        Endif
  
    sceneEnd()
    timeout(200, Ravenger_VB_Gamble_Strip_poker) // Improved by Raddeck