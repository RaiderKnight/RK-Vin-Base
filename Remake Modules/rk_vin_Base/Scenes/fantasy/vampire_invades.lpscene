WHAT: sleep
WHERE: home
WHEN: 20 - 5
WHO: none
OTHER: PercentageVampires > 0 && !Player.isRace(Vampire)

    SceneStart()
        DGetFuck = true
        Hunger = Player.getActorVar(rk_VB_Hunger)
        HungerEnable = rk_VB_EnableHunger.getGlobal()
        UrgeToPeeEnable = rk_VB_UrgeToPeeEnable.getGlobal()
        UrgeToPee = Player.getActorVar(rk_VB_UrgeToPee)
        Player.closeEyes(true)
        Player.animate(na_sleep)
        "It's a peaceful night sleep until ..."
        Actor = generatePersonTemporary()
        Actor.blendPreset(Vampire)
        Actor.dress()
        Actor.show()
        Actor(Happy):: "Finally, someone left <Player.his_or_her> window open ... I need this blood so bad ..."
        IBuyaASys = rk_VB_IBuyaASys.getGlobal()
        AlarmEnable = rk_VB_AlarmEnable.getGlobal()
        DogGuardianStats = Player.getActorVar(DogGuardianStat)
        If DogGuardianStats > 75
            DRisk = 25
        ElseIf DogGuardianStats > 50
            DRisk = 20
        ElseIf DogGuardianStats > 35
            DRisk = 15
        ElseIf DogGuardianStats > 25
            DRisk = 10
        ElseIf DogGuardianStats <= 24.8
            DRisk = 0
        EndIf
        If IBuyaASys > 0
            KRisk = 0
            If IBuyaASys == 1
                KRisk = 50
            ElseIf IBuyaASys == 2
                KRisk = 75
            ElseIf IBuyaASys == 3
                KRisk = 90
            EndIf
        EndIf
        KidnapAttemp = random(0, 100)
        TRisk = KRisk + DRisk
        Actor2 = getCreature(Dog)
        BurglarIsIn = false
        If TRisk > KidnapAttemp && AlarmEnable == 1
            If Actor2.isValid()
                Actor2(Angry):: "Warf, warf, warf, grrrr...!"
            EndIf
            "All of a sudden the alarm system starts ringing."
            Player(Curious):: "WTF, well, let's go see what's going on!"
            Player(Curious):: "Hum, I can't see anything!"
            Player(Curious):: "Let's hope it was just an animal..."
        Else
            BurglarIsIn = true
            Player.closeEyes(false)
            Player.animate()
            Actor.moveToPersonStand(Player, 100)
            Player(Angry):: "What the fuck!"
            Player(Angry):: "Stop there. What are you trying to do?"
            Player(Curious):: "Hang on ... I know what you are ... you're a vampire, aren't you? You're here for my blood."
            If Actor2.isValid()
                Actor2.show()
                If DogGuardianStats > 50 || 50 > random(1, 100)
                    bonus = random(1, 5)
                    "Before things get further out of control, my trusty guard dog <Actor2.name> came to my rescue."
                    //"<Actor2.name> aggressively attacked the home invader."
                    Actor2(Angry):: "Warf, warf, warf, grrrr...!"
                    Actor2.moveToPersonStand(Actor, 30)
                    Actor(Pain):: "Ah! Fuck,.... Ahhhhh!"
                    Actor(Pain):: "Please ... I'm desperate ... I'm starving to death ... It's been a week since I last managed to drink blood."
                Else
                    "My stupid dog didn't even wake up to come to my rescue..."
                EndIf
            Else
                Actor(Pain):: "Please ... I'm desperate ... I'm starving to death ... It's been a week since I last managed to drink blood."
            EndIf
        EndIf
        If BurglarIsIn
            "What should I do?"
            0:: "Kick <Actor.him_or_her> out"
            3:: Actor2.isValid() ::"Tell <Actor2.name> to attack"
            1:: "Offer some blood as mercy"
            2:: "Demand sex in exchange for blood"
        
            If 0
                Player:: "Get out of here now! Or I'll kill you!"
                "I couldn't care less if a vampire dies from lack of blood ..."
                If Actor:energy > energy
                    Actor(Furious)::"Ah ah ah ah! Poor you, I can feel that your energy is lower than mine so you'll pay the price... Ouaaarrgg!"
                    If isModEnabled(rk_vin_Base) || isModEnabled(rk_MoreInteractions)
                        Roundcount = 0
                        FightInAction = 0
                        While FightInAction < 1 && Player:energy > 10
                            Actor.show()
                            FightAction = random(0, 2)
                            FightAction = FightAction.round()
                            BlockAction = random(0, 3)
                            BlockAction = BlockAction.round()
                            JFightAction = random(0, 1)
                            JFightAction = JFightAction.round()
                            JFightHit = random(3, 6)
                            "What should I do?"
                            0:: Roundcount > 5::"Try to stop the fight"
                            1:: "Hit <Actor.him_or_her>"

                            If 0
                                Player(Pain)::"C'mon <Actor.name>, let's stop that fight?"
                                If Roundcount >= 20 || Actor:energy < 50 && Roundcount >= 5
                                    Actor(Pain)::"Ok for now, consider yourself lucky...!"
                                    FightInAction = 1
                                Else
                                    Actor(Evil)::"Fuck off little pussy...c'mon come..."
                                    FightInAction = 0
                                EndIf
                            Else
                                Roundcount += 1
                                If FightAction == 0
                                    Actor.moveToPersonStand(Player, 25)
                                    faceEachOther(Actor, Player)
                                    Player.animate(martialart)
                                    Actor.animate(martialart)
                                    "You completely missed your attack ... <Actor.name> blocked your move!"
                                    Player:energy -= 1
                                    FightInAction = 0
                                ElseIf FightAction == 1
                                    Actor.moveToPersonStand(Player, 25)
                                    faceEachOther(Actor, Player)
                                    Player.animate(martialart)
                                    Actor.animate(martialart)
                                    If BlockAction == 0
                                        Random
                                            "You manage to hit <Actor.him_or_her> in the face."
                                            "You manage to hit <Actor.him_or_her> in his genitals."
                                            "You manage to hit <Actor.him_or_her> in his rib cage."
                                            "You manage to hit <Actor.him_or_her> with a front kick."
                                            "You manage to hit <Actor.him_or_her> with a knee kick." 
                                        EndRandom
                                        Actor:energy -= 5
                                    ElseIf BlockAction == 1
                                        Random
                                            "You manage to hit <Actor.him_or_her> in the face."
                                            "You manage to hit <Actor.him_or_her> in his genitals."
                                            "You manage to hit <Actor.him_or_her> in his rib cage."
                                            "You manage to hit <Actor.him_or_her> with a front kick."
                                            "You manage to hit <Actor.him_or_her> with a knee kick." 
                                        EndRandom
                                        Actor:energy -= 3
                                    ElseIf BlockAction == 2
                                        Random
                                            "You manage to hit <Actor.him_or_her> in the face."
                                            "You manage to hit <Actor.him_or_her> in his genitals."
                                            "You manage to hit <Actor.him_or_her> in his rib cage."
                                        EndRandom
                                        Actor:energy -= 2
                                    ElseIf BlockAction == 3
                                        "You manage to hit <Actor.him_or_her> in the face."
                                        Actor:energy -= 1
                                    EndIf
                                    If JFightAction > 0
                                        Actor.animate(martialart)
                                        DefendHit = random(0, 4)
                                        DefendHit = DefendHit.round()
                                        If DefendHit == 0
                                            "<Actor.name> respond with <Actor.his_or_her> fist in your face!"
                                            Player:energy -= JFightHit 
                                        ElseIf DefendHit == 1
                                            "<Actor.name> respond with a hit in your genitals."
                                            Player:energy -= JFightHit + 2
                                        ElseIf DefendHit == 2
                                            "<Actor.name> respond with a hit in your rib cage."
                                            Player:energy -= JFightHit + 1
                                        ElseIf DefendHit == 3
                                            "<Actor.name> respond with a front kick."
                                            Player:energy -= JFightHit + 3
                                        ElseIf DefendHit == 4
                                            "<Actor.name> respond with a knee kick." 
                                            Player:energy -= JFightHit + 3
                                        ElseIf DefendHit >= 5
                                            "<Actor.name> gets back into fighting position."
                                        EndIf
                                    EndIf
                                    FightInAction = 0
                                ElseIf FightAction == 2
                                    BlockAction = random(0, 5) //Typeofhits
                                    BlockAction = BlockAction.round()
                                    Actor.moveToPersonStand(Player, 25)
                                    faceEachOther(Actor, Player)
                                    Player.animate(martialart)
                                    Actor.animate(martialart)
                                    If BlockAction == 0
                                        Random
                                            "<Actor.name> manage to hit you in your genitals."
                                            "<Actor.name> manage to hit you in your rib cage."
                                            "<Actor.name> manage to hit you with a nice uppercut punch."
                                            "<Actor.name> manage to give you a good punch in the throat." 
                                        EndRandom
                                        Player:energy -= 5
                                    ElseIf BlockAction == 1
                                        Random
                                            "<Actor.name> manage to hit you with a double punch in the face."
                                            "<Actor.name> manage to hit you with a front kick."
                                            "<Actor.name> manage to hit you with a knee kick." 
                                        EndRandom
                                        Player:energy -= 3
                                    ElseIf BlockAction == 2
                                        Random
                                            "<Actor.name> manage to hit you with an elbow to the face."
                                            "<Actor.name> manage to hit you with a good palm strike."
                                        EndRandom
                                        Player:energy -= 2
                                    ElseIf BlockAction == 3
                                        "<Actor.name> manage to hit you with a straight punch in the face."
                                        Player:energy -= 1
                                    Else
                                        Actor.moveToPersonStand(Player, 25)
                                        faceEachOther(Actor, Player)
                                        Player.animate(martialart)
                                        Actor.animate(martialart)
                                        "<Actor.name> completely missed <Actor.his_or_her> attack ... You managed to block <Actor.his_or_her> move!"
                                        Player:energy -= 1
                                    EndIf
                                    If JFightAction > 0
                                        Actor.animate(martialart)
                                        DefendHit = random(0, 7)
                                        DefendHit = DefendHit.round()
                                        If DefendHit == 0
                                            "You respond with your fist in <Actor.his_or_her> face!"
                                            Actor:energy -= JFightHit
                                        ElseIf DefendHit == 1
                                            "I respond with a hit in <Actor.his_or_her> genitals."
                                            Actor:energy -= JFightHit + 2
                                        ElseIf DefendHit == 2
                                            "I respond with a hit in <Actor.his_or_her> rib cage."
                                            Actor:energy -= JFightHit + 1
                                        ElseIf DefendHit == 3
                                            "I respond with a front kick."
                                            Actor:energy -= JFightHit + 3
                                        ElseIf DefendHit == 4
                                            "I respond with a knee kick." 
                                            Actor:energy -= JFightHit + 3
                                        ElseIf DefendHit >= 5
                                            "I gets back into fighting position."
                                        EndIf
                                    EndIf
                                    FightInAction = 0
                                EndIf
                            EndIf
                            If Player:energy < 10
                                FightingLost = true
                                FightInAction = 2
                            ElseIf Actor:energy < 10
                                IlAPerdu = true
                                FightInAction = 2
                            EndIf
                        EndWhile
                        If Player:energy < 10
                            FightingLost = true
                            FightInAction = 2
                        ElseIf Actor:energy < 10
                            IlAPerdu = true
                            FightInAction = 2
                        EndIf
                        TempStatA = Actor:energy
                        TempStatP = Player:energy
                        TempStatA > TempStatP
                        If FightingLost && TempStatA > TempStatP
                            VraiLoser = true
                        ElseIf FightingLost && TempStatP > TempStatA
                            IlAPerdu = true
                        ElseIf TempStatA > TempStatP
                            VraiLoser = true
                        Else TempStatP > TempStatA
                            IlAPerdu = true
                        EndIf
                        If VraiLoser
                            fitness -= 1
                            attractiveness -= 1
                            Actor.animate()
                            "<Actor.name> win the fight, <Actor.he_or_she> beat me all the way..."
                            "Suddenly everything goes black ... you lost your consciousness."
                            Player.animate(knockedout)
                            Actor:rapportwithplayer -= 5
                            Actor:attractiontoplayer -= 1
                            If isModEnabled(vin_NonConsensual) && Actor:arousal > 10 && Actor:perversion > 50
                                Actor(Angry)::"I'm not done with you, <Player.scum_or_bitch>!"
                                "<Actor.name> stripped off all my clothes and started fucking me right here!"
                                Player.strip()
                                Actor.dressExcept(Outerwear, Bottom, Bottom_Under)
                                Filter(Aggressive)
                                SexNoAffair(Actor, Player)
                                If HungerEnable > 0
                                    Player.modifyActorVar(rk_VB_Hunger, -3)
                                EndIf
                                passTime(0.50, 1.50)
                                Actor.hide()
                                "After a few minutes, I woke up but I'm still a little stunned…"
                                Player.animate()
                                "As you try to stand up you notice that you are naked ... and your whole body hurts. It feels like you have been beaten up."
                                Player.show()
                                "You feel something running down your <Player.ass_or_pussy>..."
                                "You touch your <Player.ass_or_pussy> to see what it is ..."
                                "It's cum, a lot of cum! It gushes literally out of your <Player.ass_or_pussy>, running down both legs ..."
                                Player(Disgusted)::"WTF..."
                                "I wiped a bit and put my clothes back on..."
                                Player.dress()
                                mood => 0
                                energy => 5
                            ElseIf random(0, 100) > 60
                                ActorLooting = random(1, 10)
                                ActorLooting = ActorLooting.round()
                                ActorLootingCash = random(10, 200)
                                ActorLootingCash_loc = ActorLootingCash.convertToLocalCurrency()
                                If ActorLooting > 6
                                    "<Actor.name> stoled you <ActorLootingCash_loc> from your pockets."
                                    money -= ActorLootingCash
                                EndIf
                                Actor.hide()
                                Actor:rapportwithplayer -= 50
                                Actor:attractiontoplayer -= 50
                                passTime(0.15, 0.50)
                            Else
                                "After a few minutes, I woke up but I'm still a little stunned…"
                            EndIf
                            Player.closeEyes(false)
                            Player.animate()
                            mood => 5
                            energy => 5
                            "Going back home..."
                            moveTo(home)
                            SceneEnd()
                        EndIf
                        If IlAPerdu
                            "I win the fight, <Actor.he_or_she> will stay quiet for a few..."
                            Actor.animate(knockedout)
                            Actor.closeEyes(true)
                            "What do I do?"
                            0::"Loot <Actor.him_or_her>"
                            1::"Fuck <Actor.him_or_her>"
                            99::"Nothing"
                                            
                            If 0
                                FindMoney = random(50, 50000)
                                FindMoney_Loc = FindMoney.convertToLocalCurrency()
                                FindWeedg = random(2, 7) 
                                WeedVar = random(1, 4)
                                WeedVar = WeedVar.round()
                                If WeedVar == 1
                                    VarWeed = "<FindWeedg>g of Sunset Sherbet"
                                    Player.modifyActorVar(stock_SSweed, FindWeedg)
                                ElseIf WeedVar == 2
                                    divideWeed = FindWeedg/2
                                    divideWeed2 = FindWeedg/2
                                    VarWeed = "<divideWeed>g of Bruce Banner and <divideWeed2>g of Gorilla Glue"
                                    Player.modifyActorVar(stock_BBweed, divideWeed)
                                    Player.modifyActorVar(stock_GGweed, divideWeed2)
                                ElseIf WeedVar == 3
                                    divideWeed = FindWeedg/2
                                    divideWeed1 = FindWeedg/2
                                    divideWeed2 = FindWeedg/2
                                    VarWeed = "<divideWeed>g of Sunset Sherbet, <divideWeed1>g of AK 47 and <divideWeed2>g of Gorilla Glue"
                                    Player.modifyActorVar(stock_SSweed, divideWeed)
                                    Player.modifyActorVar(stock_GGweed, divideWeed2)
                                    Player.modifyActorVar(stock_AK47weed, divideWeed1)
                                ElseIf WeedVar == 4
                                    divideWeed = FindWeedg/2
                                    divideWeed1 = FindWeedg/2
                                    divideWeed2 = FindWeedg/2
                                    divideWeed3 = FindWeedg/2
                                    VarWeed = "<divideWeed>g of Sunset Sherbet, <divideWeed3>g of Pineapple Express, <divideWeed1>g of AK 47 and <divideWeed2>g of Gorilla Glue"
                                    Player.modifyActorVar(stock_SSweed, divideWeed)
                                    Player.modifyActorVar(stock_AK47weed, divideWeed1)
                                    Player.modifyActorVar(stock_GGweed, divideWeed2)
                                    Player.modifyActorVar(stock_PEweed, divideWeed3)
                                EndIf
                                "You find <FindMoney_Loc> and <FindWeedg>g of weeds! <VarWeed>."
                                mood += 1
                                money += FindMoney
                            ElseIf 1
                                Player.dressExcept(Outerwear, Bottom)
                                Actor.strip()
                                Filter(Aggressive)
                                SexNoAffair(Player, Actor)
                                If HungerEnable > 0
                                    Player.modifyActorVar(rk_VB_Hunger, -2)
                                EndIf
                                passTime(0.50, 1.50)
                            EndIf
                        EndIf
                    EndIf
                    rk_VB_vampire_invades.setGlobal(1)
                Else
                    Actor(Sarcastic)::"Consider yourself lucky for today! If I ever get hungry again, I'll think of you!"
                    Actor(Evil)::"Ah ah ah ah!"
                    Actor.hide()
                EndIf
            Elseif 1
                Player(Serene):: "Well, if it's to save a life then I guess it's no different from a normal blood donation at the hospital"
                animatePair(Actor, Player, Kissing)
                "The vampire sucked out some of my blood, which saved <Actor.his_or_her> life, but I feel quite weakened."
                fitness -= 0.5
                attractiveness -= 0.5
                If HungerEnable > 0
                    Player.modifyActorVar(rk_VB_Hunger, -15)
                EndIf
                karma += 20
                "Once <Actor.he_or_she> was satisfied, <Actor.he_or_she> left without saying a word!..."
                If Actor.isInterestedIn(Player)
                    ArgComptant = random(100, 500)
                    ArgComptantloc = ArgComptant.convertToLocalCurrency()
                    Player(Happy)::"Wait... Cool! <Actor.He_or_She> left me money for the service! <ArgComptantloc> exactly!"
                    money += ArgComptant
                Else
                    Player(Annoyed)::"Pfff!"
                EndIf
                energy -= random(3, 5)
            ElseIf 2
                Player(Flirty):: "I can spare you some blood, but in exchange, you'll have to fuck me afterwards."
                Actor(Annoyed):: "Alright ... I guess I have no other choice ... It's this or death."
                Sex(Player, Actor)
                If HungerEnable > 0
                    Player.modifyActorVar(rk_VB_Hunger, -5)
                EndIf
                "After we mate..."
                Actor(Curious):: "Now, about our deal ..."
                Player(Scared):: "Sure, here's my arm! Don't be too greedy, I want to stay alive!"
                Actor(Grin):: "Don't worry, I won't hurt you!"
                animatePair(Actor, Player, Kissing)
                "The vampire sucked out some of my blood, which saved <Actor.his_or_her> life, but I feel quite weakened."
                fitness -= 0.5
                attractiveness -= 0.5
                energy -= random(3, 5)
                "Once <Actor.he_or_she> was satisfied, <Actor.he_or_she> left without saying a word!..."
                If Actor.isInterestedIn(Player)
                    ArgComptant = random(100, 500)
                    ArgComptantloc = ArgComptant.convertToLocalCurrency()
                    Player(Happy)::"Wait... Cool! <Actor.He_or_She> left me money for the service! <ArgComptantloc> exactly!"
                    money += ArgComptant
                Else
                    Player(Annoyed)::"Pfff!"
                EndIf
            Else
                fightStart = true
            EndIf
        EndIf
        If fightStart
            If DogGuardianStats < 70
                "The vampire managed to knock down my dog..."
                mood -= 5
                Actor2:energy => 25
                Player.modifyActorVar(DogGuardianStat, -1)
                DGetFuck = true
            Else
                "After a few painful bites, the vampire panicked and fled." 
                Actor.hide() 
                Player(Happy):: "Oh my God, <Actor2.name>, you saved me!"
                Player.modifyActorVar(DogGuardianStat, bonus)
                If isModEnabled(vin_Bestiality) && Actor2.isInterestedIn(Player)
                    CookieForDog = true
                Else
                    Player(Happy):: "Good dog! Here some cookies and a big bowl of your best meal."
                    Actor2(Happy):: "Wouf..."
                    Actor2:energy += 25
                    Actor2:rapportwithplayer += 1
                EndIf
            EndIf
        EndIf
        If isModEnabled(vin_Bestiality) && DGetFuck
            Actor.strip()
            Actor.dressExcept(Headwear)
            "To make matters worse, the burglar decides to fuck my dog too."
            Player(Crying):: "No, please stop ... not my dog too!"
            "I am too weak to move, I can't do anything for my dog..."
            Filter(Aggressive)
            TalkNonConsensual()
            SexNoAffair(Actor, Actor2)
        EndIf
        If CookieForDog
            "I can't help but notice that the fight with the home invader seemed to have brought out the animalistic instinct in <Actor2.name>. <Actor2.He_or_She> seems 'excited'." // Edit Vin
            0:: "Reward my hero dog with sex"
            1:: "Some dog treats are good enough rewards"
            
            If 0
                "A hero saving the damsel in distress deserves to get laid. That hero not being human shouldn't matter."
                Player.strip()
                Sex(Actor2, Player)
                If HungerEnable > 0
                    Player.modifyActorVar(rk_VB_Hunger, -3)
                EndIf
            EndIf
        EndIf
    SceneEnd() // Improved by Raddeck
    timeout(300, vampire_invades)