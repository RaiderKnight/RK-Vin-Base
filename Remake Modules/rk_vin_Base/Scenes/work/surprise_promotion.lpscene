WHAT: all
WHERE: work
WHEN: 12 - 20
WHO: Actor = getSpecific(Boss); Actor2 = getSpecific(Dating); If Actor.isInterestedIn(Actor2) && Actor2.isInterestedIn(Actor) && Actor:perversion > 50 && Actor:masochist < 0 && [Actor2:perversion > 50 || OpenRelationship()]
OTHER: jobexperience < 80 && isModEnabled(vin_NTR)

    
    SceneStart()
        contiStory = false
        Hunger = Player.getActorVar(rk_VB_Hunger)
        HungerEnable = rk_VB_EnableHunger.getGlobal()
        UrgeToPeeEnable = rk_VB_UrgeToPeeEnable.getGlobal()
        UrgeToPee = Player.getActorVar(rk_VB_UrgeToPee)
        Arranged = Actor.getActorVar(tag_BossFuckingSO)
        Boss_Sucker = Player.getActorVar(rk_VB_Boss_Sucker)
        GoldDigger = Actor2.getActorVar(rk_VB_GoldDigger)
        If Arranged == 0
            "I'm a bit hungover today as it's the day after a plus one office party. I brought my <Actor2.boyfriend_or_girlfriend> <Actor2.name> along and we stayed a bit too late. <Actor2.name> even chatted with the boss for a long time for some reason."
            "The boss must feel tired as well as <Actor.he_or_she> already left the office early after lunch. Well ... <Actor.he_or_she>'s the boss ... who's going to stop <Actor.him_or_her> from going home early."
            "Just as I was taking it easy for the day, I got an e-mail from HR ... Just great ... These usually lead to tedious things to do."
            "Oh wait ..."
            "'Congratulations on your promotion. Please find enclosed your revised contract.'"
            "Wait, what? The next performance review is still a long way to go and I haven't been performing that well recently. How the hell did the boss give me a promotion? Maybe <Actor.he_or_she> will explain tomorrow morning."
            mood += random(15, 30)
            Player(Happy):: "I guess it's my lucky day!"
            Player.animate(write)
            "I took no time at all to sign the new contract with the new position and a nice new salary to go with it."
            Salary = getSalary()
            Salary *= random(1.3, 1.5)
            Salary.setSalary()
            jobexperience += 20
            timeoutPrecise(1440, ask_for_promotion)    
            Player.animate()
            "Having had a lazy day coupled with a pleasant surprise, I couldn't wait to get home to tell my <Actor2.boyfriend_or_girlfriend> about my new promotion. Maybe bringing <Actor2.him_or_her> along to the office party last night was the lucky charm."
            moveTo(home)
            setBackgroundCustom(livingroom)
            Player(Happy):: "Hey babe, you won't believe what happened in the office today! I got a ..."
            "Where the fuck <Actor2.he_or_she> is??"
            Actor.show()
            Actor2.show()
            If OpenRelationship()
                Player(Shocked):: "Well well well! ..."
                mood -= random(5, 10)
            Else
                Player(Shocked):: "What the fuck!"
                mood -= random(15, 30)
            EndIf
            Sex(Actor, Actor2)
            Actor(Grin):: "Don't act so shocked! You didn't really think you deserved that promotion for your average performances on the job, did you?"
            Actor(Grin):: "You see, your <Actor2.boyfriend_or_girlfriend> was so concerned about your lack of career progression and approached me at the office party last night and gave me a deal I couldn't really turn down."
            Actor(Grin):: "I would promote you and keep you in the job as long as I'm allowed to come over and fuck <Actor2.him_or_her> any time I see fit."
            Actor2(Sad):: "Don't be angry, honey. It's for the best of our future together."
            "What should I do?"
            0:: "Consent to the arrangement"
            1:: "Put an end to it"
            
            If 0
                Player(Sad)::"I thought we we're supposed to consult each other before fucking someone else..."
                Player(Sad):: "Okay ... I guess I have no choice ..."
                arousal -= random(5, 10)
                perversion -= random(15, 30)
                "The new compensation package to come with the promotion is truly very generous and since <Actor2.name> already went through with it anyway ..."
                masochist += 10
                Actor.setActorVar(tag_BossFuckingSO, 1)
                AGD = random(1, 3)
                Actor2.modifyActorVar(rk_VB_GoldDigger, AGD)
            Else
                If OpenRelationship()
                    Player(Serene)::"It's okay for this time but I want to put an end to this arrangement..."
                    Actor2(Sad)::"Sorry I thought it was a good idea...!"
                    Player(Serene)::"And you boss, you can leave now..."
                    Actor(Sad)::"Well, I thought you we're polyamourous so... anyway, bye!"
                    Actor.hide()
                    "I showed my boss the door and had a little argument with my <Actor2.boyfriend_or_girlfriend> about how we're supposed to consult each other before fucking someone else..."
                    "Thankfully, I already signed the new contract today and my boss couldn't really tell HR that <Actor.he_or_she> changed <Actor.his_or_her> mind so swiftly, so I kept the promotion ... for now."
                    Player(Wink):: "The idea was good but not with my boss, I already see <Actor.him_or_her> 40 hours a week, I don't want to see <Actor.him_or_her> here either!"
                    Actor2(Grin)::"Well, I was thinking more about the money behind it all! I love you so I trust you!"
                    Player(Wink)::"I have a sneaky feeling that my boss will probably fire me in the next performance review. There's another jobs anyway..."
                    Actor2(Serene)::"We'll see!"
                    masochist -= 5
                    arousal -= random(1, 3)
                    perversion -= random(1, 3)
                    jobperformance -= random(50, 100)
                Else
                    Player.modifyActorVar(rk_VB_Boss_Sucker, -5)
                    Player(Angry):: "I didn't know you were a slut, I trusted you, there are many ways to bring money on the table my dear, but you ruined everything!"
                    Actor2(Sad)::"Honey... listen!"
                    Player(Angry)::"And you profiteer, get the fuck out before I get really mad and you feel like you have to fire me because I beat you..."
                    Actor(Shocked)::"Well... sorry, bye!"
                    Player(Angry):: "Get the fuck out of my place!"
                    GoldDigger > 75
                    If GoldDigger > 75 && money < 100000
                        Actor2(Evil)::"Wait <Actor.name>, I'm coming with you!"
                        Actor(Shocked)::"Well... ok!"
                        Actor2(Evil)::"That's it, this is the end, I'm leaving with <Actor.him_or_her>! <Actor.he_or_she>'s more rich than you so fuck off!"
                        Actor.hide()
                        Actor2.hide()
                        "I really should have seen it coming ..."
                        "Since my <Actor2.boyfriend_or_girlfriend> became a 'Gold Digger', our relationship is no longer the same. Because <Actor2.he_or_she>'s only interested in money and luxury, <Actor2.he_or_she> eventually with my boss permanently instead ..."
                        Actor2.setDatingId()
                        loseDating()
                        addNpcRelationship(Dating, Actor, Actor2)
                    Else
                        contiStory = true
                    EndIf
                    If contiStory
                        Actor.hide()
                        Player.moveToPersonStand(Actor2, 40)
                        Player(Angry):: "And you, we need to talk..."
                        "I angrily kicked my boss out and had a big argument with my <Actor2.boyfriend_or_girlfriend> who still insisted <Actor2.he_or_she> only did it to help me."
                        masochist -= 5
                        arousal -= random(5, 10)
                        perversion -= random(15, 30)
                        "Thankfully, I already signed the new contract today and my boss couldn't really tell HR that <Actor.he_or_she> changed <Actor.his_or_her> mind so swiftly, so I kept the promotion ... for now."
                        "I have a sneaky feeling that my boss will probably fire me in the next performance review."
                        jobperformance -= random(50, 100)
                        Actor2:attractiontoplayer -= 20
                        If Actor2:attractiontoplayer < 0
                            Actor2.modifyActorVar(rk_VB_GoldDigger, 5)
                            Actor2(Evil)::"You know what? ... That's it, this is the end, I'm leaving! <Actor.name> <Actor.he_or_she>'s more rich than you so fuck off!"
                            Actor2.hide()
                            "I really should have seen it coming ..."
                            "But after a few encounters between my <Actor2.boyfriend_or_girlfriend> and my boss, our relationship was no longer the same and eventually <Actor2.name> figured <Actor2.he_or_she> might as well skip the middle man in me and just go and be with my boss permanently instead ..."
                            Actor2.setDatingId()
                            loseDating()
                            addNpcRelationship(Dating, Actor, Actor2)
                        EndIf
                    EndIf
                EndIf
            EndIf
        Else
            Actor.dress()
            Actor.show()
            "The boss is about to leave the office shortly after lunch again, giving me a wink before <Actor.he_or_she> left. No doubt <Actor.he_or_she>'s heading straight to my place to fuck my <Actor2.boyfriend_or_girlfriend> as we arranged."
            "Did I change my mind about our arrangement?"
            0:: "Let <Actor.him_or_her>"
            1:: "Put an end to the arrangement"
            
            If 0
                Actor2.modifyActorVar(rk_VB_GoldDigger, 1)
                If !OpenRelationship()
                    Actor2:attractiontoplayer -= random(0, 2)
                EndIf
                "I know I don't really deserve my current position and is only kept here due to this arrangement. Let's just rock the boat."
                setBackgroundCustom(livingroom)
                Player.hide()
                Actor2.show()
                jobperformance => 100
                "Meanwhile at my place, my dedicated <Actor2.boyfriend_or_girlfriend> was already waiting for my boss naked."
                Sex(Actor, Actor2)
                Actor.hide()
                Actor2.hide()
                If Actor2:attractiontoplayer < 0
                    "I really should have seen it coming ..."
                    "But after a few encounters between my <Actor2.boyfriend_or_girlfriend> and my boss, our relationship was no longer the same and eventually <Actor2.name> figured <Actor2.he_or_she> might as well skip the middle man in me and just go and be with my boss permanently instead ..."
                    Actor2.setDatingId()
                    loseDating()
                    addNpcRelationship(Dating, Actor, Actor2)
                ElseIf GoldDigger > 75 && money < 100000
                    "I really should have seen it coming ..."
                    "Since my <Actor2.boyfriend_or_girlfriend> became a 'Gold Digger', our relationship is no longer the same. Because <Actor2.he_or_she>'s only interested in money and luxury, <Actor2.he_or_she> eventually with my boss permanently instead ..."
                    Actor2.setDatingId()
                    loseDating()
                    addNpcRelationship(Dating, Actor, Actor2)
                EndIf
            Else
                Player.modifyActorVar(rk_VB_Boss_Sucker, -5)
                Actor.setActorVar(tag_BossFuckingSO, 0)
                "This has gone on long enough and to be honest, I think I merit my current position now. There's no need to exchange it for my <Actor2.boyfriend_or_girlfriend> any longer."
                "I told the boss that the arrangement is over and if <Actor.he_or_she> decides to take revenge in the next performance review, I'll face the consequences."
                masochist -= 5
                jobperformance -= random(50, 100)
            EndIf
        EndIf
    SceneEnd()
    timeout(200, surprise_promotion)