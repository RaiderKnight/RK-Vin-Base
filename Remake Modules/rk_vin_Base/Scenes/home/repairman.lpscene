WHAT: all, -pickpocket, -go_to_the_bathroom, -sleep, -sleep_hotel, -nap, -nap_hotel, -rk_VB_small_sleep
WHERE: home
WHEN: 6-22
WHO: none
OTHER: IsAtHome() && intelligence < Random(0, 1)*Random(0, 1)*Random(0, 1)*30*actionDuration

    SceneStart()
    
        Hunger = Player.getActorVar(rk_VB_Hunger)
        HungerEnable = rk_VB_EnableHunger.getGlobal()
        IBuyaTV = Player.getActorVar(rk_VB_IBuyaTV)
        IBuyaWashingMachine = Player.getActorVar(rk_VB_IBuyaWashingMachine)
        IBuyaTumbleDryer = Player.getActorVar(rk_VB_IBuyaTumbleDryer)
        IBuyaOvenStoves = Player.getActorVar(rk_VB_IBuyaOvenStoves)
        IBuyaMicrowave = Player.getActorVar(rk_VB_IBuyaMicrowave)
        IBuyaRefrigerator = Player.getActorVar(rk_VB_IBuyaRefrigerator)
        IBuyaAirConditioner = Player.getActorVar(rk_VB_IBuyaAirConditioner)
        EquipmentRandom = Random(1, 11)
        EquipmentRandom = EquipmentRandom.round()
        
        If EquipmentRandom == 1
        
            If IBuyaTV > 0
                Equipment = "TV"
            Else
                SceneEnd()
            EndIf
            
        ElseIf EquipmentRandom == 2
        
            If IBuyaWashingMachine > 0
                Equipment = "washing machine"
            Else
                SceneEnd()
            EndIf
            
        ElseIf EquipmentRandom == 3
        
            If IBuyaMicrowave > 0
                Equipment = "microwave"
            Else
                SceneEnd()
            EndIf
            
        ElseIf EquipmentRandom == 4
        
            If IBuyaTumbleDryer > 0
                Equipment = "dryer"
            Else
                SceneEnd()
            EndIf
            
        ElseIf EquipmentRandom == 5
        
            If IBuyaRefrigerator > 0
                Equipment = "fridge"
            Else
                SceneEnd()
            EndIf
            
        ElseIf EquipmentRandom == 6
        
            Equipment = "dishwasher"
            
        ElseIf EquipmentRandom == 7
        
            If IBuyaOvenStoves > 0
                Equipment = "oven"
            Else
                SceneEnd()
            EndIf
            
        ElseIf EquipmentRandom == 8
        
            If IBuyaOvenStoves > 0
                Equipment = "stove"
            Else
                SceneEnd()
            EndIf
            
        ElseIf EquipmentRandom == 9
            
            Equipment = "heater"
            
        ElseIf EquipmentRandom == 10
             
            If IBuyaAirConditioner > 0
                Equipment = "air conditioner"
            Else
                SceneEnd()
            EndIf
            
        ElseIf EquipmentRandom == 11
       
            Equipment = "shower"
            
        EndIf
        
        
        setbackground(home)
        Player(Angry):: "Damn it! Why won't this work?"
        "Oh no, my <Equipment> is broken and I have no idea to fix it. I'm going to need to call a repairman."
        "An hour or so later ..."
        passTime(0.5, 1.5)
        Repairman = generatePerson()
        Random
            Repairman.blendPreset(athletic)
            Repairman.blendPreset(bodybuilder)
            Repairman.blendPreset(stocky1)
            Repairman.blendPreset(stocky2)
        endRandom
    
        Repairman.randomizeFace()
        Repairman.randomizeHairs()
        Repairman.dress()
        Repairman.dress(Worksuit)
        Repairman.show(2)
    
        Repairman(Happy):: "Here you are. The <Equipment> is working again ..."
        Player(Excited):: "Great! Thank you so much. You're a true lifesaver."
        Fee = Random(30, 200)
        FeeConverted = Fee.convertToLocalCurrency(true)
        CanExchangeNumber = true
        Repairman(Happy):: "That would be <FeeConverted> in total, please."
        0:: "Pay"
        1:: perversion > 50:: "Offer sex instead"
    
        If 0
            "I happily gave him the money for services well rendered."
            money -= Fee
        Else
            Player(Flirty):: "Actually, I can think of a much more pleasurable way to pay you for your efforts ..."
            If Repairman.IsInterestedIn(Player) && Repairman:perversion + Repairman:attractiontoplayer > Random(0, 50)
                Repairman(Flirty):: "How can I say no? An offer like that rarely comes by ..."
                perversion += Random(0, 0.5)
                Sex(Repairman, Player)
                If HungerEnable > 0
                    Player.modifyActorVar(rk_VB_Hunger, -1)
                EndIf
                Repairman.show(2)
                Player(Flirty):: "Wow, that was something else! You certainly know how to use your 'tools'."
                Repairman(Flirty):: "You flattered me. I've never had a client 'paying' like you before."
            Else
                Repairman(Angry):: "I'm afraid I'm just a honest tradesman and 'pleasure' doesn't quite pay the bills ..."
                Player(Angry):: "Fine, it's your loss. Take your money then!"
                CanExchangeNumber = false
                money -= Fee
            Endif
        Endif
    
        If CanExchangeNumber
            "Before he leaves, should I exchange contacts with him?"
            0:: "Yes"
            1:: "No"
            
            If 0
                "We exchanged numbers and the repairman soon left."
                exchangeContact(Repairman)
            Else
                "Why should I? I barely know the guy."
                "Having received the reward for his services, the repairman soon left." 
            Endif
        Endif
    
        timeout(500, repairman)
    SceneEnd() // Improved by Raddeck