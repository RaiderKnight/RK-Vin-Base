WHAT: none
WHERE: none
WHEN: 0 - 24
WHO: none
OTHER: none

    SceneStart()
        NouvAmi = false
        Dating = getSpecific(PassedOn)
        If Dating.isValid()
            Dating.show()
        Else
            If isWithCompanion()
                Dating = CurrentCompanion
                Dating.show()
            Else
                Dating = getSpecific(Dating)
                If Dating.isValid()
                    Dating.show()
                EndIf
            EndIf
        EndIf
        Actor2 = getCompanionCreature()
        If Actor2.isValid() && Actor2.isCreatureType(Dog)
            Actor2.hide()
        EndIf
        If Actor88.isValid()
            Actor88.show()
            Player(Flirty)::"Hi, would you be interested in fucking a hooker with me?"
            If !Actor88.isInterestedIn(Player)
                Actor88(Shocked)::"Are you sick! Besides you are not my type..."
                Actor88:rapportwithplayer -= random(0, 10)
                Actor88:attractiontoplayer -= random(0, 10)
                SceneEnd()
            ElseIf Actor88.isInterestedIn(Player) || Actor88:arousal < 14
                Actor88(Flirty)::"I would like to, but I have already a lover."
                Actor88:rapportwithplayer += random(0, 1)
                Actor88:attractiontoplayer += random(0, 1)
                SceneEnd()
            ElseIf Actor88.isInterestedIn(Player) && Actor88:arousal < 14 && Actor88:perversion < 50
                Actor88(Flirty)::"I would like to, but I'm really not in the mood..."
                Actor88:rapportwithplayer += random(0, 1)
                Actor88:attractiontoplayer += random(0, 2)
                SceneEnd()
            Else
                Actor88(Flirty)::"Well, yes, offered for free by a handsome <Player.guy_or_girl> like you, why not!"
                Actor88:rapportwithplayer += random(0.5, 1)
                Actor88:attractiontoplayer += random(1, 3)
                NouvAmi = true
            EndIf
        EndIf
        If WHERE == home && Actor2.isValid() && Actor2.isCreatureType(Dog) && isModEnabled(vin_Bestiality)
            beastEnabl = true
        EndIf
        MonPPU = false
        MonPPD = false
        Hunger = Player.getActorVar(rk_VB_Hunger)
        HungerEnable = rk_VB_EnableHunger.getGlobal()
        UrgeToPeeEnable = rk_VB_UrgeToPeeEnable.getGlobal()
        UrgeToPee = Player.getActorVar(rk_VB_UrgeToPee)
        femaOui = false
        mascOui = false
        conti = false
        conti3 = true
        Agency = generatePersonTemporary()
        Agency.hide()
        Noway = false
        NowayDecu = false
        If isModEnabled(rk_vin_Base)
            EtAlors = false
            conti6 = false
            conti7 = true
            tranOui = false
            DitNon = false
            PartipourUn = false
            PartipourDeux = false
            ChercheCul = true
            paiePoDat = false
            paiePoDeu = false
            paiePoMoe = false
            paiePoDatA = false
            paiePoDeuA = false
            // paiePoDeuAA = false
            paiePoMoeA = false
            While ChercheCul
                If conti3
                    MonPPU = false
                    MonPPD = false
                    conti = false
                    Noway = false
                    NowayDecu = false
                    EtAlors = false
                    conti6 = false
                    conti7 = true
                    tranOui = false
                    paiePoDat = false
                    paiePoDeu = false
                    paiePoMoe = false
                    paiePoDatA = false
                    paiePoDeuA = false
                    paiePoMoeA = false
                    femaOui = false
                    mascOui = false
                
                    "What should I choose?"
                    0::"A woman"
                    1::"A man"
                    2::"A trans"
                    3:: isModEnabled(rk_vin_Fantasy)::"I want an elf, orc or a vampire"
                    99::"I changed my mind"
                    
                    If 0
                        GtxtC = "woman"
                        femaOui = true
                        EtAlors = true
                    ElseIf 1
                        GtxtC = "man"
                        mascOui = true
                        EtAlors = true
                    ElseIf 2
                        GtxtC = "trans"
                        tranOui = true
                        EtAlors = true
                    ElseIf 3
                        If Actor88.isValid()
                            passOn(Actor88)
                        ElseIf Dating.isValid()
                            passOn(Dating)
                        EndIf
                        followUp(rk_VB_call_a_hookxxFanta)
                        ChercheCul = false
                        conti7 = false
                    Else
                        ChercheCul = false
                        Noway = true
                    EndIf
                    If EtAlors
                        If WHERE == brothel
                            "There are a lot of escorts hanging out here, so it will be easy to find what I am looking for!"
                        ElseIf WHERE == stripclub
                            "After looking around, I found a stripper willing to fuck that is within my budget."  
                        Else
                            "I did some search on the internet and found a hooker that does outcalls and is within my budget."            
                        EndIf
                        "What type of ethnicity do you have a preference for?"
                        0::"Arab <GtxtC>"
                        1::"Asian <GtxtC>"
                        2::"Black <GtxtC>"
                        3::"Latin <GtxtC>"
                        4::"Indian <GtxtC>"
                        5::"White <GtxtC>"
                        6::"I don't care!"
                        
                        If 0
                            setRaceGenerated(arab)
                        ElseIf 1
                            setRaceGenerated(asian)
                        ElseIf 2
                            setRaceGenerated(black)
                        ElseIf 3
                            setRaceGenerated(latin)
                        ElseIf 4
                            setRaceGenerated(indian)
                        ElseIf 5
                            setRaceGenerated(white)
                        Else
                            Actor.randomizeRace()
                        EndIf
                        If femaOui
                            Actor = generatePersonTemporary()
                            While !Actor.isFemale()
                                Actor = generatePersonTemporary()
                            EndWhile
                            Actor.dressUniform(sexwork)
                        ElseIf mascOui
                            Actor = generatePersonTemporary()
                            While !Actor.isMale() && !Actor.isTrans()
                                Actor = generatePersonTemporary()
                            EndWhile
                            Actor.dress()
                        ElseIf tranOui
                            Actor = generatePersonTemporary()
                            While !Actor.isTrans()
                                Actor = generatePersonTemporary()
                            EndWhile
                            Actor.dress()
                        EndIf
                        cestcool = false
                        cestcoolD = false
                        If Actor88.isValid()
                            cestcool = true
                            "I am searching for an escort with my friend <Actor88.name>, what are my intentions?"
                            0::"To pay <Actor88.him_or_her> a hooker and watch"
                            1::"To fuck a hooker with <Actor88.him_or_her>"
                            2::"To fuck a hooker in front of <Actor88.him_or_her>"
                            
                            //3::Dating.isValid()::"To fuck a hooker with <Actor88.him_or_her> and my <Dating.boyfriend_or_girlfriend>"
                            
                            If 0
                                paiePoDatA = true
                            ElseIf 1
                                paiePoDeuA = true
                            ElseIf 2
                                paiePoMoeA = true
                                // Else
                                // paiePoDeuAA = true
                                // cestcool = true
                            EndIf
                            If paiePoDatA
                                MonPPU = true
                            ElseIf paiePoDeuA
                                MonPPD = true
                            ElseIf paiePoMoeA
                                MonPPU = true
                                // ElseIf paiePoDeuAA
                                // MonPPDA = true
                            EndIf
                        EndIf
                        If !cestcool && Dating.isValid() && !Actor88.isValid()
                            cestcoolD = true
                            "I am looking for an escort in the presence of my <Dating.boyfriend_or_girlfriend>, what are my intentions?"
                            0::"To pay <Dating.him_or_her> a hooker and watch"
                            1::"To fuck a hooker with <Dating.him_or_her>"
                            2::"To fuck a hooker in front of <Dating.him_or_her>"
                            
                            If 0
                                paiePoDat = true
                            ElseIf 1
                                paiePoDeu = true
                            Else
                                paiePoMoe = true
                            EndIf
                            If paiePoDat || paiePoDeu
                                If Dating:perversion > 50 || [Dating.isInterestedIn(Player) && Dating:rapportwithplayer > 30] || OpenRelationship() || [Dating.isInterestedIn(Player) && Dating:arousal > 15] || Dating:incest > 50
                                    Dating(Flirty):: "Alright, let's have some fun."
                                    Dating:rapportwithplayer += random(0, 1)
                                    Dating:attractiontoplayer += random(0, 1)
                                    MonPPD = true
                                ElseIf Dating:arousal < 50 || [Dating.isInterestedIn(Player) && Dating:rapportwithplayer > 15] || Dating:incest < 50
                                    Dating(Curious)::"Ok, that's what you were looking at, no, not today, I'm not in the mood to fuck!"
                                    MonPPU = true
                                Else
                                    Dating(Curious)::"Ok, that's what you were looking at, not really interested!"
                                    MonPPU = true
                                EndIf
                            EndIf
                            If MonPPU
                                "<Dating.He_or_She> is really not interested, do I still call an escort?"
                                0::"Yes"
                                1::"No"
                                
                                If 1
                                    SceneEnd()
                                EndIf
                            EndIf
                            If paiePoDat
                                MonPPU = true
                            ElseIf paiePoDeu
                                MonPPD = true
                            ElseIf paiePoMoe
                                MonPPU = true
                            EndIf
                        EndIf
                        If Actor2.isValid()
                            If Actor:attractiveness > 90
                                BeastP2 = random(900, 1500)
                            ElseIf Actor:attractiveness > 70
                                BeastP2 = random(500, 1000)
                            ElseIf Actor:attractiveness > 50
                                BeastP2 = random(300, 500)
                            Else
                                BeastP2 = random(75, 100)
                            EndIf
                            BeastPl2 = BeastP2.convertToLocalCurrency()
                            BeastP3 = BeastP2 + random(50, 100)
                            BeastPl3 = BeastP3.convertToLocalCurrency()
                        EndIf
                        If MonPPD
                            If Actor:attractiveness > 90
                                BeastP = random(200, 500)
                            ElseIf Actor:attractiveness > 70
                                BeastP = random(110, 200)
                            ElseIf Actor:attractiveness > 50
                                BeastP = random(100, 150)
                            Else
                                BeastP = random(90, 100)
                            EndIf
                            If Actor:attractiveness > 90
                                BeastP9 = BeastP + random(100, 250)
                            ElseIf Actor:attractiveness > 70
                                BeastP9 = BeastP + random(100, 200)
                            ElseIf Actor:attractiveness > 50
                                BeastP9 = BeastP + random(100, 150)
                            Else
                                BeastP9 = BeastP + random(50, 100)
                            EndIf    
                            BeastPl9 = BeastP9.convertToLocalCurrency()
                        Else
                            If Actor:attractiveness > 90
                                BeastP = random(200, 500)
                            ElseIf Actor:attractiveness > 70
                                BeastP = random(100, 200)
                            ElseIf Actor:attractiveness > 50
                                BeastP = random(100, 150)
                            Else
                                BeastP = random(90, 100)
                            EndIf   
                            BeastPl = BeastP.convertToLocalCurrency()
                        EndIf
                        Random
                            Actor.blendPreset(twenties)
                            Actor.blendPreset(thirties)
                        EndRandom        
                        Actor.randomizeHairs()
                        Actor.randomizeFace()
                        conti = true
                        Actor.hide()
                    EndIf
                EndIf
                If conti
                    If Actor.isEthnic(black) && Actor.isMale() && !isTimingOut(strt_black_m)
                        Actor.blendPreset(strt_black_m)
                        
                    ElseIf Actor.isEthnic(black) && !Actor.isMale() && !isTimingOut(strt_black_f)
                        Actor.blendPreset(strt_black_f)

                    ElseIf Actor.isEthnic(indian) && Actor.isMale() && !isTimingOut(strt_indian_m)
                        Actor.blendPreset(strt_indian_m)
                        
                    ElseIf Actor.isEthnic(indian) && !Actor.isMale() && !isTimingOut(strt_indian_f)
                        Actor.blendPreset(strt_indian_f)
                        
                    ElseIf Actor.isEthnic(arab) && Actor.isMale() && !isTimingOut(strt_arab_m)
                        Actor.blendPreset(strt_arab_m)
                        
                    ElseIf Actor.isEthnic(arab) && !Actor.isMale() && !isTimingOut(strt_arab_f)
                        Actor.blendPreset(strt_arab_f)

                    ElseIf Actor.isEthnic(latin) && Actor.isMale() && !isTimingOut(strt_latin_m)
                        Actor.blendPreset(strt_latin_m)
                        
                    ElseIf Actor.isEthnic(latin) && !Actor.isMale() && !isTimingOut(strt_latin_f)
                        Actor.blendPreset(strt_latin_f)
                        
                    ElseIf Actor.isEthnic(asian) && Actor.isMale() && !isTimingOut(strt_asian_m)
                        Actor.blendPreset(strt_asian_m)
                        
                    ElseIf Actor.isEthnic(asian) && !Actor.isMale() && !isTimingOut(strt_asian_f)
                        Actor.blendPreset(strt_asian_f)

                    ElseIf Actor.isEthnic(white) && Actor.isMale() && !isTimingOut(strt_white_m)
                        Actor.blendPreset(strt_white_m)
                        
                    ElseIf Actor.isEthnic(white) && !Actor.isMale() && !isTimingOut(strt_white_f)
                        Actor.blendPreset(strt_white_f)
                    EndIf
                    Actor.show(2)
                    "..."
                    secondScreen(Actor)
                    Actor.show()
                    If MonPPD
                        "This hooker charges <BeastPl9> for <Actor.his_or_her> private services"
                    Else
                        "This hooker charges <BeastPl> for <Actor.his_or_her> private services"
                    EndIf
                    "Should I arrange to have sex with <Actor.him_or_her>?"
                    0:: money > BeastP9 ::"Yes"
                    1:: "Too expensive"
                    2:: "Check another one"
                    
                    If 0
                        conti6 = true
                        If MonPPD
                            money -= BeastP9
                        Else
                            money -= BeastP
                        EndIf
                        ChercheCul = false
                    ElseIf 1
                        NowayDecu = true
                        ChercheCul = false
                        conti7 = false
                    EndIf
                    Actor.hide()
                    secondScreen()
                EndIf
            EndWhile
            If conti6
                Actor.show()
                If WHERE == brothel
                    Random
                        setBackground3D(Modules/vin_Base/Bedrooms/0.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/1.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/2.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/3.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/4.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/5.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/6.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/7.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/8.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/9.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/10.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/11.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/12.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/13.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/14.lpworld)
                        setBackground3D(Modules/vin_Base/Bedrooms/15.lpworld)
                    EndRandom
                    "The hooker guided me into one of the brothel's bedrooms and we got it on right away."
                Else
                    "In no time at all, the hooker arrived and we got it on immediately."
                EndIf
                If random(0, 100) < 10 || [random(0, 100) < 25 && isModEnabled(vin_Interracial)]
                    Freedom = false
                    "Within a few minutes of meeting this exotic fresh blood, I couldn't help but notice how much <Actor.he_or_she> struggles with the language and seems to know nothing about this country or anyone here."
                    "It was obvious as day that this prostitute has been a victim of human trafficking ..."
                    0:: "Don't care, fuck <Actor.him_or_her> anyway"
                    1:: "Intimidate the pimp into giving the prostitute freedom"
                    2:: "Pay the pimp a ransom for the prostitute's freedom"
                    3:: "Just walk away"
                    
                    If 0
                        "It's none of my business how the prostitute got here. All I care about is that <Actor.he_or_she>'s hot and I want to fuck <Actor.him_or_her>."
                        GoFucEsco = true
                        karma -= 5
                    ElseIf 3
                        "I don't want to get into trouble with the law for getting involved in some human trafficking gang ..."
                        "I don't want to be a hero either, so it's best to just chicken out of the deal and walk away."
                        moveTo(home)
                    ElseIf 2
                        "I negotiated a ransom with <Actor.his_or_her> 'agency' aka captors and managed to secure <Actor.his_or_her> freedom."
                        money -= 1000
                        karma += 30
                        Freedom = true
                    ElseIf 1
                        If random(0, 100) < interpersonal
                            "I threatened to expose to the local authorities what the escort agency is up to in terms of human trafficking unless they set <Actor.him_or_her> free. Thankfully, my tactic worked and I secured <Actor.his_or_her> freedom."
                            karma += 30
                            Freedom = true
                        Else
                            "Unfortunately, clearly backed up by a dangerous gang, the pimp laughed at my intimidation tactic and simply took <Actor.his_or_her> trafficked slave away to pimp to someone else."
                        EndIf
                    EndIf
                    
                    If Freedom
                        "The now-freed human trafficking victim called me <Actor.his_or_her> saviour sent by God. We keep in touch and I'm pretty sure <Actor.he_or_she> has developed a permanent bond with me now after my heroic act and I can ask <Actor.him_or_her> out anytime if I want to ..."
                        Actor.makePermanent()
                        exchangeContact(Actor)
                        Actor:rapportwithplayer += 50
                        Actor:attractiontoplayer += 50
                    EndIf
                Else
                    GoFucEsco = true
                EndIf
                If GoFucEsco
                    Actor.strip()
                    If paiePoDat
                        Dating.strip()
                        Sex(Dating, Actor)
                        addNpcRelationship(JohnSexWorker, Dating, Actor)
                    ElseIf paiePoDeu
                        Dating.strip()
                        Player.strip()
                        Sex(Dating, Actor, Player)
                        addNpcRelationship(JohnSexWorker, Dating, Actor)
                        If HungerEnable > 0
                            Player.modifyActorVar(rk_VB_Hunger, -2)
                        EndIf
                    ElseIf paiePoMoe
                        Player.strip()
                        Sex(Player, Actor)
                        If HungerEnable > 0
                            Player.modifyActorVar(rk_VB_Hunger, -2)
                        EndIf
                    ElseIf paiePoDatA
                        Actor88.strip()
                        Actor88(Shocked)::"What?? You don't join us?"
                        Player(Happy)::"I prefer watching...!"
                        Actor88(Happy)::"Ok?? Thanks for the gift!"
                        Sex(Actor88, Actor)
                    ElseIf paiePoDeuA
                        Player.strip()
                        Actor88.strip()
                        Sex(Actor88, Actor, Player)
                        If HungerEnable > 0
                            Player.modifyActorVar(rk_VB_Hunger, -2)
                        EndIf
                    ElseIf paiePoMoeA
                        Player.strip()
                        Player(Evil)::"Idiot, you thought I would pay you a whore! In fact, you'll be content to watch me fuck her like a bull in heat!"
                        Actor88(Shocked)::"What?? Fuck you!"
                        Player(Grin)::"Shut up and watch the free show!"
                        Sex(Player, Actor)
                        If HungerEnable > 0
                            Player.modifyActorVar(rk_VB_Hunger, -2)
                        EndIf
                    Else
                        Player.strip()
                        Sex(Player, Actor)
                        If HungerEnable > 0
                            Player.modifyActorVar(rk_VB_Hunger, -2)
                        EndIf
                    EndIf
                    perversion += random(0, 0.5)
                    AmNotVirgin => 1
                    If beastEnabl
                        Actor2.show()
                        "Too occupied at fucking the prostitute, I didn't notice that our intense love making session has got my pet dog <Actor2.name> all excited."
                        "It's clear that <Actor2.he_or_she> got horny from watching us and wants a piece of the action. Unless satisfied, <Actor2.he_or_she> will spend the night barking and won't let me sleep, I'm sure."
                        "What should I do?"
                        0:: "Relieve <Actor2.name> myself"
                        1:: "Pay the hooker extra to do it"
                        2:: "Pay the hooker to have a threesome"
                        3:: "Do nothing"
                    
                        If 0
                            "I paid the hooker and left for another clients. Good service that was!"
                            Actor.hide()
                            Sex(Player, Actor2)
                            If HungerEnable > 0
                                Player.modifyActorVar(rk_VB_Hunger, -2)
                            EndIf
                        ElseIf 1
                            If !Actor.isInterestedIn(Actor2)
                                DitNon = true
                            Else
                                PartipourUn = true
                            EndIf
                        ElseIf 2
                            If !Actor.isInterestedIn(Actor2)
                                DitNon = true
                            Else
                                PartipourDeux = true
                            EndIf
                        EndIf
                    Else
                        "I paid the hooker and <Actor2.he_or_she> left for another clients. Good service that was!"
                        conti7 = false
                    EndIf
                EndIf
            EndIf
            If PartipourUn
                "The hooker charge <BeastPl2> for an extras!"
                "What should I do?"
                0::money > BeastP2 :: "Accept"
                1:: "Refuse"
                
                If 0
                    conti7 = true
                    money -= BeastP2
                Else
                    NowayDecu = true
                EndIf
            EndIf
            If PartipourDeux
                "The hooker charge <BeastPl3> for an extras!"
                "What should I do?"
                0::money > BeastP3 :: "Accept"
                1:: "Refuse"
                
                If 1
                    conti7 = true
                    money -= BeastP3
                Else
                    NowayDecu = true
                EndIf
            EndIf
            If conti7
                If PartipourUn
                    Actor(Flirty):: "Why not, always love easy cash!"
                    Sex(Actor2, Actor)
                    If HungerEnable > 0
                        Player.modifyActorVar(rk_VB_Hunger, -2)
                    EndIf
                EndIf
                If PartipourDeux
                    Actor(Flirty):: "Why not, always love easy cash!"
                    Sex(Actor2, Player, Actor)
                    If HungerEnable > 0
                        Player.modifyActorVar(rk_VB_Hunger, -3)
                    EndIf
                EndIf
                "I paid the hooker and <Actor.he_or_she> left for another clients. Good service that was!"
            EndIf
            If DitNon
                If Actor.isInterestedIn(Player)
                    Actor(Shocked)::"Are you crazy, I don't offer that kind of service!"
                Else
                    Actor(Flirty)::"I don't offer this kind of service but there are other agencies for that!"
                EndIf
                "I paid the hooker and <Actor.he_or_she> left for another clients. It was a good service anyway!"
                Actor.hide()
            EndIf
            If Noway
                SceneEnd()
            EndIf
            If NowayDecu
                "No way. I'm not so desperate that I have to pay to get laid."
            EndIf
        EndIf
    SceneEnd() // Improved by Raddeck